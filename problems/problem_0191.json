{
  "description": "SW1wbGVtZW50IHRoZSBQQ0EgY29sb3IgZGlzdG9ydGlvbiB0ZWNobmlxdWUgdXNlZCBpbiBBbGV4TmV0IGZvciBkYXRhIGF1Z21lbnRhdGlvbi4gVGhpcyBtZXRob2QgYXBwbGllcyBQQ0EgdG8gdGhlIFJHQiBwaXhlbCB2YWx1ZXMgb2YgbmF0dXJhbCBpbWFnZXMsIHRoZW4gYWRkcyBtdWx0aXBsZXMgb2YgdGhlIHByaW5jaXBhbCBjb21wb25lbnRzIHdpdGggbWFnbml0dWRlcyBwcm9wb3J0aW9uYWwgdG8gdGhlIGNvcnJlc3BvbmRpbmcgZWlnZW52YWx1ZXMgdGltZXMgYSByYW5kb20gdmFyaWFibGUuIEdpdmVuIGFuIFJHQiBpbWFnZSAoSCwgVywgMyksIGNvbXB1dGUgdGhlIHByaW5jaXBhbCBjb21wb25lbnRzIG9mIFJHQiB2YWx1ZXMgYW5kIGFwcGx5IHRoZSBjb2xvciBkaXN0b3J0aW9uIHdpdGggc3BlY2lmaWVkIGFscGhhIHZhbHVlcy4=",
  "id": "191",
  "test_cases": [
    {
      "test": "import numpy as np\nnp.random.seed(42)\nimage = np.random.randint(0, 256, (2, 2, 3)).astype(np.uint8)\nalpha = np.array([0.1, -0.05, 0.03])\nresult = pca_color_augmentation(image, alpha)\nprint(np.round(result, 2))",
      "expected_output": "[[[ 96.82, 187.95, 93.53], [ 8.82, 114.95, 72.53]], [[182.82, 28.95, 103.53], [115.82, 218.95, 215.53]]]"
    },
    {
      "test": "import numpy as np\nnp.random.seed(123)\nimage = np.random.randint(0, 256, (3, 3, 3)).astype(np.uint8)\nalpha = np.array([0.2, 0.1, -0.1])\nresult = pca_color_augmentation(image, alpha)\nprint(np.round(result, 2))",
      "expected_output": "[[[236.65, 103.11, 129.51], [48.65, 214.11, 101.51], [212.65, 11.11, 86.51]], [[88.65, 117.11, 60.51], [196.65, 219.11, 99.51], [95.65, 120.11, 50.51]], [[55.65, 26.11, 177.51], [206.65, 105.11, 156.51], [65.65, 72.11, 255. ]]]"
    }
  ],
  "difficulty": "hard",
  "video": "",
  "likes": "0",
  "dislikes": "0",
  "example": {
    "input": "np.random.seed(42)\nimage = np.random.randint(0, 256, (2, 2, 3)).astype(np.uint8)\nalpha = np.array([0.1, -0.05, 0.03])\nresult = pca_color_augmentation(image, alpha)\nprint(result)",
    "output": "[[[ 97  98  99]\n  [144 145 146]]\n\n [[243 244 245]\n  [ 32  33  34]]]",
    "reasoning": "The function computes PCA on the RGB pixel values, then applies a color distortion based on the principal components weighted by alpha values. The distortion is added to all pixels and the result is clamped to [0, 255]."
  },
  "category": "Computer Vision",
  "starter_code": "import numpy as np\n\ndef pca_color_augmentation(image: np.ndarray, alpha: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Apply PCA color augmentation to an RGB image.\n    \n    Args:\n        image: RGB image of shape (H, W, 3) with values in [0, 255]\n        alpha: Array of 3 random coefficients for principal components\n    \n    Returns:\n        Augmented image of shape (H, W, 3) with values clamped to [0, 255]\n    \"\"\"\n    # Your code here\n    pass",
  "title": "PCA Color Augmentation",
  "createdAt": "October 21, 2025 at 11:27:37â€¯AM UTUTC-4",
  "contributor": [
    {
      "profile_link": "https://github.com/moe18",
      "name": "moe"
    }
  ],
  "learn_section": "IyMgVW5kZXJzdGFuZGluZyBBbGV4TmV0IFBDQSBDb2xvciBBdWdtZW50YXRpb24KClBDQSBDb2xvciBBdWdtZW50YXRpb24gaXMgYSBkYXRhIGF1Z21lbnRhdGlvbiB0ZWNobmlxdWUgaW50cm9kdWNlZCBpbiBBbGV4TmV0IHRoYXQgcGVyZm9ybXMgc29waGlzdGljYXRlZCBjb2xvciBzcGFjZSB0cmFuc2Zvcm1hdGlvbnMgdG8gaW5jcmVhc2UgZGF0YXNldCBkaXZlcnNpdHkgYW5kIGltcHJvdmUgbW9kZWwgcm9idXN0bmVzcy4KCiMjIyBNYXRoZW1hdGljYWwgRm91bmRhdGlvbgoKKipTdGVwIDE6IEV4dHJhY3QgUkdCIHBpeGVsIHZhbHVlcyoqCkZvciBhbiBSR0IgaW1hZ2Ugb2Ygc2hhcGUgJChILCBXLCAzKSQsIHJlc2hhcGUgdG8gZ2V0IGFsbCBwaXhlbCB2YWx1ZXMgYXMgYSBtYXRyaXggJFgkIG9mIHNoYXBlICQoSCBcdGltZXMgVywgMykkIHdoZXJlIGVhY2ggcm93IHJlcHJlc2VudHMgYW4gUkdCIHBpeGVsLgoKKipTdGVwIDI6IENvbXB1dGUgbWVhbi1jZW50ZXJlZCBkYXRhKioKJCRcYmFye1h9ID0gWCAtIFxtdSQkCndoZXJlICRcbXUkIGlzIHRoZSBtZWFuIFJHQiB2YWx1ZSBhY3Jvc3MgYWxsIHBpeGVscy4KCioqU3RlcCAzOiBDb21wdXRlIGNvdmFyaWFuY2UgbWF0cml4KioKJCRDID0gXGZyYWN7MX17bi0xfSBcYmFye1h9XlQgXGJhcntYfSQkCndoZXJlICRuID0gSCBcdGltZXMgVyQgaXMgdGhlIG51bWJlciBvZiBwaXhlbHMuCgoqKlN0ZXAgNDogRWlnZW4gZGVjb21wb3NpdGlvbioqCiQkQyA9IFAgXExhbWJkYSBQXlQkJAp3aGVyZToKLSAkUCQgPSBlaWdlbnZlY3RvcnMgKHByaW5jaXBhbCBjb21wb25lbnRzKSBvZiBzaGFwZSAkKDMsIDMpJAotICRcTGFtYmRhJCA9IGRpYWdvbmFsIG1hdHJpeCBvZiBlaWdlbnZhbHVlcyAkW1xsYW1iZGFfMSwgXGxhbWJkYV8yLCBcbGFtYmRhXzNdJAoKKipTdGVwIDU6IEdlbmVyYXRlIGNvbG9yIGRpc3RvcnRpb24qKgokJFx0ZXh0e2Rpc3RvcnRpb259ID0gUCBcY2RvdCAoXGFscGhhIFxvZG90IFxzcXJ0e1xMYW1iZGF9KSQkCndoZXJlOgotICRcYWxwaGEgPSBbXGFscGhhXzEsIFxhbHBoYV8yLCBcYWxwaGFfM10kIGFyZSByYW5kb20gY29lZmZpY2llbnRzICh0eXBpY2FsbHkgc2FtcGxlZCBmcm9tICRcbWF0aGNhbHtOfSgwLCAwLjEpJCkKLSAkXG9kb3QkIGRlbm90ZXMgZWxlbWVudC13aXNlIG11bHRpcGxpY2F0aW9uCi0gJFxzcXJ0e1xMYW1iZGF9ID0gW1xzcXJ0e1xsYW1iZGFfMX0sIFxzcXJ0e1xsYW1iZGFfMn0sIFxzcXJ0e1xsYW1iZGFfM31dJAoKKipTdGVwIDY6IEFwcGx5IGF1Z21lbnRhdGlvbioqCiQkWF97XHRleHR7YXVnbWVudGVkfX0gPSBYICsgXHRleHR7ZGlzdG9ydGlvbn0kJAoKIyMjIFdoeSBQQ0EgQ29sb3IgQXVnbWVudGF0aW9uPwoKMS4gKipOYXR1cmFsIENvbG9yIFZhcmlhdGlvbnMqKjogQ2FwdHVyZXMgbmF0dXJhbCBsaWdodGluZyB2YXJpYXRpb25zIGluIHJlYWwgaW1hZ2VzCjIuICoqSWxsdW1pbmF0aW9uIEludmFyaWFuY2UqKjogTWFrZXMgbW9kZWxzIHJvYnVzdCB0byBkaWZmZXJlbnQgbGlnaHRpbmcgY29uZGl0aW9ucwozLiAqKlJlZHVjZWQgT3ZlcmZpdHRpbmcqKjogSW5jcmVhc2VzIGVmZmVjdGl2ZSBkYXRhc2V0IHNpemUgdGhyb3VnaCBtZWFuaW5nZnVsIGF1Z21lbnRhdGlvbnMKNC4gKipQcmVzZXJ2ZXMgT2JqZWN0IElkZW50aXR5Kio6IENvbG9yIGNoYW5nZXMgYXJlIHJlYWxpc3RpYyBhbmQgZG9uJ3QgYWx0ZXIgb2JqZWN0IHNlbWFudGljcwoKIyMjIEtleSBQcm9wZXJ0aWVzCgotICoqUHJpbmNpcGFsIENvbXBvbmVudCAxKio6IFVzdWFsbHkgY2FwdHVyZXMgb3ZlcmFsbCBicmlnaHRuZXNzL2ludGVuc2l0eQotICoqUHJpbmNpcGFsIENvbXBvbmVudCAyKio6IE9mdGVuIHJlcHJlc2VudHMgY29sb3IgdGVtcGVyYXR1cmUgKHdhcm0gdnMgY29vbCkKLSAqKlByaW5jaXBhbCBDb21wb25lbnQgMyoqOiBDYXB0dXJlcyBzYXR1cmF0aW9uIGFuZCBzcGVjaWZpYyBjb2xvciBzaGlmdHMKCiMjIyBBbGV4TmV0IFJlc3VsdHMKCkluIHRoZSBvcmlnaW5hbCBBbGV4TmV0IHBhcGVyLCB0aGlzIHRlY2huaXF1ZToKLSBSZWR1Y2VkIHRvcC0xIGVycm9yIHJhdGUgYnkgb3ZlciAxJQotIE1hZGUgdGhlIG5ldHdvcmsgbW9yZSByb2J1c3QgdG8gbGlnaHRpbmcgdmFyaWF0aW9ucwotIEhlbHBlZCBhY2hpZXZlIHN0YXRlLW9mLXRoZS1hcnQgSW1hZ2VOZXQgcGVyZm9ybWFuY2UKCiMjIyBJbXBsZW1lbnRhdGlvbiBOb3RlcwoKLSBBcHBseSBvbmx5IGR1cmluZyB0cmFpbmluZywgbm90IGluZmVyZW5jZQotIFR5cGljYWwgJFxhbHBoYSQgdmFsdWVzOiAkXGFscGhhX2kgXHNpbSBcbWF0aGNhbHtOfSgwLCAwLjEpJAotIENhbiBiZSBjb21iaW5lZCB3aXRoIG90aGVyIGF1Z21lbnRhdGlvbnMgKHJvdGF0aW9uLCBjcm9wcGluZywgZXRjLikKLSBDbGFtcCBmaW5hbCBwaXhlbCB2YWx1ZXMgdG8gdmFsaWQgcmFuZ2UgWzAsIDI1NV0KCiMjIyBNb2Rlcm4gVXNhZ2UKCldoaWxlIG5ld2VyIGF1Z21lbnRhdGlvbiB0ZWNobmlxdWVzIGV4aXN0IChBdXRvQXVnbWVudCwgUmFuZEF1Z21lbnQpLCBQQ0EgY29sb3IgYXVnbWVudGF0aW9uIHJlbWFpbnM6Ci0gQSBzdGFuZGFyZCBiYXNlbGluZSBpbiBjb21wdXRlciB2aXNpb24KLSBFZmZlY3RpdmUgZm9yIG1lZGljYWwgaW1hZ2luZyB3aGVyZSBjb2xvciB2YXJpYXRpb25zIG1hdHRlcgotIFVzZWZ1bCBpbiBkb21haW5zIHdpdGggbGltaXRlZCB0cmFpbmluZyBkYXRh",
  "description_decoded": "Implement the PCA color distortion technique used in AlexNet for data augmentation. This method applies PCA to the RGB pixel values of natural images, then adds multiples of the principal components with magnitudes proportional to the corresponding eigenvalues times a random variable. Given an RGB image (H, W, 3), compute the principal components of RGB values and apply the color distortion with specified alpha values.",
  "learn_section_decoded": "## Understanding AlexNet PCA Color Augmentation\n\nPCA Color Augmentation is a data augmentation technique introduced in AlexNet that performs sophisticated color space transformations to increase dataset diversity and improve model robustness.\n\n### Mathematical Foundation\n\n**Step 1: Extract RGB pixel values**\nFor an RGB image of shape $(H, W, 3)$, reshape to get all pixel values as a matrix $X$ of shape $(H \\times W, 3)$ where each row represents an RGB pixel.\n\n**Step 2: Compute mean-centered data**\n$$\\bar{X} = X - \\mu$$\nwhere $\\mu$ is the mean RGB value across all pixels.\n\n**Step 3: Compute covariance matrix**\n$$C = \\frac{1}{n-1} \\bar{X}^T \\bar{X}$$\nwhere $n = H \\times W$ is the number of pixels.\n\n**Step 4: Eigen decomposition**\n$$C = P \\Lambda P^T$$\nwhere:\n- $P$ = eigenvectors (principal components) of shape $(3, 3)$\n- $\\Lambda$ = diagonal matrix of eigenvalues $[\\lambda_1, \\lambda_2, \\lambda_3]$\n\n**Step 5: Generate color distortion**\n$$\\text{distortion} = P \\cdot (\\alpha \\odot \\sqrt{\\Lambda})$$\nwhere:\n- $\\alpha = [\\alpha_1, \\alpha_2, \\alpha_3]$ are random coefficients (typically sampled from $\\mathcal{N}(0, 0.1)$)\n- $\\odot$ denotes element-wise multiplication\n- $\\sqrt{\\Lambda} = [\\sqrt{\\lambda_1}, \\sqrt{\\lambda_2}, \\sqrt{\\lambda_3}]$\n\n**Step 6: Apply augmentation**\n$$X_{\\text{augmented}} = X + \\text{distortion}$$\n\n### Why PCA Color Augmentation?\n\n1. **Natural Color Variations**: Captures natural lighting variations in real images\n2. **Illumination Invariance**: Makes models robust to different lighting conditions\n3. **Reduced Overfitting**: Increases effective dataset size through meaningful augmentations\n4. **Preserves Object Identity**: Color changes are realistic and don't alter object semantics\n\n### Key Properties\n\n- **Principal Component 1**: Usually captures overall brightness/intensity\n- **Principal Component 2**: Often represents color temperature (warm vs cool)\n- **Principal Component 3**: Captures saturation and specific color shifts\n\n### AlexNet Results\n\nIn the original AlexNet paper, this technique:\n- Reduced top-1 error rate by over 1%\n- Made the network more robust to lighting variations\n- Helped achieve state-of-the-art ImageNet performance\n\n### Implementation Notes\n\n- Apply only during training, not inference\n- Typical $\\alpha$ values: $\\alpha_i \\sim \\mathcal{N}(0, 0.1)$\n- Can be combined with other augmentations (rotation, cropping, etc.)\n- Clamp final pixel values to valid range [0, 255]\n\n### Modern Usage\n\nWhile newer augmentation techniques exist (AutoAugment, RandAugment), PCA color augmentation remains:\n- A standard baseline in computer vision\n- Effective for medical imaging where color variations matter\n- Useful in domains with limited training data"
}