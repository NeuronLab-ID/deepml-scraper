{
  "description": "SW1wbGVtZW50IGEgYmF0Y2ggaXRlcmFibGUgZnVuY3Rpb24gdGhhdCBzYW1wbGVzIGluIGEgbnVtcHkgYXJyYXkgWCBhbmQgYW4gb3B0aW9uYWwgbnVtcHkgYXJyYXkgeS4gVGhlIGZ1bmN0aW9uIHNob3VsZCByZXR1cm4gYmF0Y2hlcyBvZiBhIHNwZWNpZmllZCBzaXplLiBJZiB5IGlzIHByb3ZpZGVkLCB0aGUgZnVuY3Rpb24gc2hvdWxkIHJldHVybiBiYXRjaGVzIG9mIChYLCB5KSBwYWlyczsgb3RoZXJ3aXNlLCBpdCBzaG91bGQgcmV0dXJuIGJhdGNoZXMgb2YgWCBvbmx5Lg==",
  "mdx_file": "22f2b530-bcba-49e0-965d-9d9416bd1057.mdx",
  "id": "30",
  "test_cases": [
    {
      "test": "print(batch_iterator(np.array([[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]), np.array([1, 2, 3, 4, 5]), batch_size=2))",
      "expected_output": "[[[[1, 2], [3, 4]], [1, 2]], [[[5, 6], [7, 8]], [3, 4]], [[[9, 10]], [5]]]"
    },
    {
      "test": "print(batch_iterator(np.array([[1, 1], [2, 2], [3, 3], [4, 4]]), batch_size=3))",
      "expected_output": "[[[1, 1], [2, 2], [3, 3]], [[4, 4]]]"
    }
  ],
  "difficulty": "easy",
  "pytorch_difficulty": "easy",
  "video": "https://youtu.be/_Ox2PUBpkMw?si=oiWBJezQQoREIHPU",
  "likes": "0",
  "example": {
    "input": "X = np.array([[1, 2], \n                  [3, 4], \n                  [5, 6], \n                  [7, 8], \n                  [9, 10]])\n    y = np.array([1, 2, 3, 4, 5])\n    batch_size = 2\n    batch_iterator(X, y, batch_size)",
    "output": "[[[[1, 2], [3, 4]], [1, 2]],\n     [[[5, 6], [7, 8]], [3, 4]],\n     [[[9, 10]], [5]]]",
    "reasoning": "The dataset X contains 5 samples, and we are using a batch size of 2. Therefore, the function will divide the dataset into 3 batches. The first two batches will contain 2 samples each, and the last batch will contain the remaining sample. The corresponding values from y are also included in each batch."
  },
  "dislikes": "0",
  "category": "Machine Learning",
  "starter_code": "import numpy as np\n\ndef batch_iterator(X, y=None, batch_size=64):\n\t# Your code here\n\tpass",
  "title": "Batch Iterator for Dataset",
  "learn_section": "CiMjIFVuZGVyc3RhbmRpbmcgQmF0Y2ggSXRlcmF0aW9uCgpCYXRjaCBpdGVyYXRpb24gaXMgYSBjb21tb24gdGVjaG5pcXVlIHVzZWQgaW4gbWFjaGluZSBsZWFybmluZyBhbmQgZGF0YSBwcm9jZXNzaW5nIHRvIGhhbmRsZSBsYXJnZSBkYXRhc2V0cyBtb3JlIGVmZmljaWVudGx5LiBJbnN0ZWFkIG9mIHByb2Nlc3NpbmcgdGhlIGVudGlyZSBkYXRhc2V0IGF0IG9uY2UsIHdoaWNoIGNhbiBiZSBtZW1vcnktaW50ZW5zaXZlLCBkYXRhIGlzIHByb2Nlc3NlZCBpbiBzbWFsbGVyLCBtb3JlIG1hbmFnZWFibGUgYmF0Y2hlcy4KCiMjIyBTdGVwLWJ5LVN0ZXAgTWV0aG9kIHRvIENyZWF0ZSBhIEJhdGNoIEl0ZXJhdG9yCgoxLiAqKkRldGVybWluZSB0aGUgTnVtYmVyIG9mIFNhbXBsZXMqKiAgCiAgIENhbGN1bGF0ZSB0aGUgdG90YWwgbnVtYmVyIG9mIHNhbXBsZXMgaW4gdGhlIGRhdGFzZXQuCgoyLiAqKkl0ZXJhdGUgaW4gQmF0Y2hlcyoqICAKICAgTG9vcCB0aHJvdWdoIHRoZSBkYXRhc2V0IGluIGluY3JlbWVudHMgb2YgdGhlIHNwZWNpZmllZCBiYXRjaCBzaXplLgoKMy4gKipZaWVsZCBCYXRjaGVzKiogIAogICBGb3IgZWFjaCBpdGVyYXRpb24sIHlpZWxkIGEgYmF0Y2ggb2Ygc2FtcGxlcyBmcm9tIFwoIFggXCkgYW5kLCBpZiBwcm92aWRlZCwgdGhlIGNvcnJlc3BvbmRpbmcgc2FtcGxlcyBmcm9tIFwoIHkgXCkuCgojIyMgS2V5IFBvaW50ClRoaXMgbWV0aG9kIGVuc3VyZXMgZWZmaWNpZW50IHByb2Nlc3NpbmcgYW5kIGNhbiBiZSB1c2VkIGZvciBib3RoIHRoZSB0cmFpbmluZyBhbmQgZXZhbHVhdGlvbiBwaGFzZXMgaW4gbWFjaGluZSBsZWFybmluZyB3b3JrZmxvd3MuCgo=",
  "contributor": [
    {
      "profile_link": "https://github.com/eriklindernoren/ML-From-Scratch",
      "name": "Erik Linder-Nor√©n"
    }
  ],
  "pytorch_test_cases": [
    {
      "test": "import numpy as np, torch; from __main__ import shuffle_data; Xs, ys = shuffle_data(np.array([[1,2],[3,4],[5,6],[7,8]]), np.array([1,2,3,4]), seed=42); print((Xs.numpy(), ys.numpy()))",
      "expected_output": "(array([[1, 2],[5, 6],[3, 4],[7, 8]]), array([1, 3, 2, 4]))"
    },
    {
      "test": "import numpy as np, torch; from __main__ import shuffle_data; Xs, ys = shuffle_data(np.array([[1,1],[2,2],[3,3],[4,4]]), np.array([10,20,30,40]), seed=24); print((Xs.numpy(), ys.numpy()))",
      "expected_output": "(array([[1, 1],[3, 3],[4, 4],[2, 2]]), array([10, 30, 40, 20]))"
    }
  ],
  "pytorch_starter_code": "aW1wb3J0IHRvcmNoCmZyb20gdG9yY2gudXRpbHMuZGF0YSBpbXBvcnQgVGVuc29yRGF0YXNldCwgRGF0YUxvYWRlcgpmcm9tIHR5cGluZyBpbXBvcnQgVHVwbGUKCmRlZiBzaHVmZmxlX2RhdGEoWCwgeSwgc2VlZD1Ob25lKSAtPiBUdXBsZVt0b3JjaC5UZW5zb3IsIHRvcmNoLlRlbnNvcl06CiAgICAiIiIKICAgIFVzZSBUZW5zb3JEYXRhc2V0IGFuZCBEYXRhTG9hZGVyIHRvIHJhbmRvbWx5IHNodWZmbGUgWCBhbmQgeSB0b2dldGhlciwKICAgIG1haW50YWluaW5nIHRoZSBjb3JyZXNwb25kZW5jZSBiZXR3ZWVuIHNhbXBsZXMuCiAgICAiIiIKICAgICMgSGludDogVXNlIFRlbnNvckRhdGFzZXQgYW5kIERhdGFMb2FkZXIgd2l0aCBzaHVmZmxlPVRydWUuCiAgICBwYXNzCg==",
  "description_decoded": "Implement a batch iterable function that samples in a numpy array X and an optional numpy array y. The function should return batches of a specified size. If y is provided, the function should return batches of (X, y) pairs; otherwise, it should return batches of X only.",
  "learn_section_decoded": "\n## Understanding Batch Iteration\n\nBatch iteration is a common technique used in machine learning and data processing to handle large datasets more efficiently. Instead of processing the entire dataset at once, which can be memory-intensive, data is processed in smaller, more manageable batches.\n\n### Step-by-Step Method to Create a Batch Iterator\n\n1. **Determine the Number of Samples**  \n   Calculate the total number of samples in the dataset.\n\n2. **Iterate in Batches**  \n   Loop through the dataset in increments of the specified batch size.\n\n3. **Yield Batches**  \n   For each iteration, yield a batch of samples from \\( X \\) and, if provided, the corresponding samples from \\( y \\).\n\n### Key Point\nThis method ensures efficient processing and can be used for both the training and evaluation phases in machine learning workflows.\n\n"
}