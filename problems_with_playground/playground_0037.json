{
  "problem_id": 37,
  "title": "Calculate Correlation Matrix",
  "category": "Linear Algebra",
  "enabled": true,
  "type": "react",
  "code": "import React, { useState } from 'react';\n\nconst theme = {\n  colors: {\n    primary: '#8b5cf6',\n    background: '#0a0a0a',\n    surface: '#111111',\n    surfaceAlt: '#1a1a1a',\n    border: '#2a2a2a',\n    text: '#fafafa',\n    textSecondary: '#a1a1aa',\n    textMuted: '#52525b',\n    blue: '#38bdf8',\n    yellow: '#fbbf24',\n    pink: '#f472b6',\n    green: '#a3e635',\n    orange: '#fb923c',\n    red: '#f87171',\n  },\n  font: \"'JetBrains Mono', monospace\",\n};\n\nexport default function App() {\n  const [step, setStep] = useState(0);\n  const [playing, setPlaying] = useState(false);\n  // Editable data points [x, y]\n  const [points, setPoints] = useState([\n    [1, 2], [2, 4], [3, 5], [4, 8], [5, 9]\n  ]);\n  const [dragging, setDragging] = useState(null);\n\n  const numSteps = 4;\n  const n = points.length;\n\n  // Calculate statistics\n  const meanX = points.reduce((s, p) => s + p[0], 0) / n;\n  const meanY = points.reduce((s, p) => s + p[1], 0) / n;\n  \n  const centered = points.map(p => [p[0] - meanX, p[1] - meanY]);\n  \n  const varX = centered.reduce((s, p) => s + p[0] * p[0], 0) / n;\n  const varY = centered.reduce((s, p) => s + p[1] * p[1], 0) / n;\n  const stdX = Math.sqrt(varX);\n  const stdY = Math.sqrt(varY);\n  \n  const cov = centered.reduce((s, p) => s + p[0] * p[1], 0) / n;\n  const corr = stdX > 0 && stdY > 0 ? cov / (stdX * stdY) : 0;\n\n  const stepInfo = [\n    { title: 'Data Points', desc: 'Drag points to change correlation!', color: theme.colors.primary },\n    { title: 'Find Means', desc: `Î¼x = ${meanX.toFixed(1)}, Î¼y = ${meanY.toFixed(1)}`, color: theme.colors.blue },\n    { title: 'Center & Covariance', desc: `cov = ${cov.toFixed(2)}`, color: theme.colors.yellow },\n    { title: 'Correlation', desc: `r = cov/(ÏƒxÂ·Ïƒy) = ${corr.toFixed(3)}`, color: theme.colors.green },\n  ];\n\n  const play = async () => {\n    setPlaying(true);\n    for (let s = 0; s < numSteps; s++) {\n      setStep(s);\n      await new Promise(r => setTimeout(r, 1800));\n    }\n    setPlaying(false);\n  };\n\n  // Presets\n  const setPreset = (type) => {\n    if (type === 'positive') setPoints([[1,1],[2,3],[3,4],[4,6],[5,8]]);\n    if (type === 'negative') setPoints([[1,9],[2,7],[3,5],[4,3],[5,1]]);\n    if (type === 'none') setPoints([[1,5],[2,2],[3,8],[4,3],[5,6]]);\n    if (type === 'perfect') setPoints([[1,2],[2,4],[3,6],[4,8],[5,10]]);\n  };\n\n  // Get color for correlation value\n  const getCorrColor = (val) => {\n    if (val > 0.5) return theme.colors.green;\n    if (val < -0.5) return theme.colors.red;\n    return theme.colors.yellow;\n  };\n\n  // Scatter plot bounds\n  const plotSize = 220;\n  const padding = 20;\n  const minX = 0, maxX = 10, minY = 0, maxY = 10;\n  \n  const toPlotX = (x) => padding + ((x - minX) / (maxX - minX)) * (plotSize - 2 * padding);\n  const toPlotY = (y) => plotSize - padding - ((y - minY) / (maxY - minY)) * (plotSize - 2 * padding);\n  const fromPlotX = (px) => minX + ((px - padding) / (plotSize - 2 * padding)) * (maxX - minX);\n  const fromPlotY = (py) => minY + ((plotSize - padding - py) / (plotSize - 2 * padding)) * (maxY - minY);\n\n  const handleMouseMove = (e) => {\n    if (dragging === null) return;\n    const rect = e.currentTarget.getBoundingClientRect();\n    const px = e.clientX - rect.left;\n    const py = e.clientY - rect.top;\n    const x = Math.max(minX, Math.min(maxX, fromPlotX(px)));\n    const y = Math.max(minY, Math.min(maxY, fromPlotY(py)));\n    const newPoints = [...points];\n    newPoints[dragging] = [Math.round(x * 2) / 2, Math.round(y * 2) / 2];\n    setPoints(newPoints);\n  };\n\n  return (\n    <div style={{ background: theme.colors.background, minHeight: '100vh', padding: '12px', fontFamily: theme.font, color: theme.colors.text }}>\n      \n      {/* Header */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '8px' }}>\n        <div>\n          <div style={{ fontSize: '18px', fontWeight: '700' }}>Correlation</div>\n          <div style={{ fontSize: '12px', color: theme.colors.textSecondary }}>Measure linear relationship between X and Y</div>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n          <button onClick={() => setStep(Math.max(0, step - 1))} disabled={step === 0}\n            style={{ padding: '6px 12px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: step === 0 ? theme.colors.textMuted : theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'<'}</button>\n          <div style={{ display: 'flex', gap: '4px' }}>\n            {Array.from({ length: numSteps }, (_, i) => (\n              <div key={i} onClick={() => setStep(i)} style={{\n                width: i === step ? '16px' : '8px', height: '8px', borderRadius: '4px',\n                background: i <= step ? stepInfo[i].color : theme.colors.border, cursor: 'pointer'\n              }} />\n            ))}\n          </div>\n          <button onClick={() => setStep(Math.min(numSteps - 1, step + 1))} disabled={step === numSteps - 1}\n            style={{ padding: '6px 12px', background: step === numSteps - 1 ? theme.colors.surface : theme.colors.primary,\n              border: 'none', borderRadius: '6px', color: theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'>'}</button>\n          <button onClick={play} disabled={playing}\n            style={{ padding: '6px 12px', background: playing ? theme.colors.green : theme.colors.surface,\n              border: 'none', borderRadius: '6px', color: playing ? theme.colors.background : theme.colors.text,\n              fontSize: '12px', cursor: 'pointer' }}>{playing ? '...' : 'Play'}</button>\n        </div>\n      </div>\n\n      {/* Step info */}\n      <div style={{ padding: '10px 14px', background: theme.colors.surface, borderLeft: `4px solid ${stepInfo[step].color}`,\n        borderRadius: '0 8px 8px 0', marginBottom: '12px' }}>\n        <span style={{ fontWeight: '700', color: stepInfo[step].color, fontSize: '14px' }}>{stepInfo[step].title}: </span>\n        <span style={{ color: theme.colors.textSecondary, fontSize: '13px' }}>{stepInfo[step].desc}</span>\n      </div>\n\n      {/* Presets */}\n      <div style={{ display: 'flex', gap: '6px', marginBottom: '12px' }}>\n        <span style={{ fontSize: '11px', color: theme.colors.textMuted, alignSelf: 'center' }}>Try:</span>\n        {[['positive', '+correlation'], ['negative', 'âˆ’correlation'], ['none', 'No corr'], ['perfect', 'Perfect']].map(([key, label]) => (\n          <button key={key} onClick={() => setPreset(key)}\n            style={{ padding: '4px 10px', borderRadius: '4px', border: 'none', cursor: 'pointer',\n              background: theme.colors.surfaceAlt, color: theme.colors.textSecondary, fontSize: '11px' }}>\n            {label}\n          </button>\n        ))}\n      </div>\n\n      <div style={{ display: 'flex', gap: '16px' }}>\n        \n        {/* Left: Interactive scatter plot */}\n        <div style={{ background: theme.colors.surface, borderRadius: '12px', padding: '16px' }}>\n          <div style={{ fontSize: '12px', color: theme.colors.textMuted, marginBottom: '8px' }}>\n            Scatter Plot <span style={{ color: theme.colors.pink }}>(drag points!)</span>\n          </div>\n          \n          <svg width={plotSize} height={plotSize} \n            style={{ background: theme.colors.surfaceAlt, borderRadius: '8px', cursor: dragging !== null ? 'grabbing' : 'default' }}\n            onMouseMove={handleMouseMove}\n            onMouseUp={() => setDragging(null)}\n            onMouseLeave={() => setDragging(null)}>\n            \n            {/* Grid */}\n            {[2, 4, 6, 8].map(v => (\n              <g key={v}>\n                <line x1={toPlotX(v)} y1={padding} x2={toPlotX(v)} y2={plotSize - padding} stroke={theme.colors.border} strokeWidth=\"1\" />\n                <line x1={padding} y1={toPlotY(v)} x2={plotSize - padding} y2={toPlotY(v)} stroke={theme.colors.border} strokeWidth=\"1\" />\n              </g>\n            ))}\n            \n            {/* Axes */}\n            <line x1={padding} y1={plotSize - padding} x2={plotSize - padding} y2={plotSize - padding} stroke={theme.colors.textMuted} strokeWidth=\"2\" />\n            <line x1={padding} y1={padding} x2={padding} y2={plotSize - padding} stroke={theme.colors.textMuted} strokeWidth=\"2\" />\n            \n            {/* Mean lines */}\n            {step >= 1 && (\n              <>\n                <line x1={toPlotX(meanX)} y1={padding} x2={toPlotX(meanX)} y2={plotSize - padding} \n                  stroke={theme.colors.blue} strokeWidth=\"2\" strokeDasharray=\"4\" />\n                <line x1={padding} y1={toPlotY(meanY)} x2={plotSize - padding} y2={toPlotY(meanY)} \n                  stroke={theme.colors.blue} strokeWidth=\"2\" strokeDasharray=\"4\" />\n                <text x={toPlotX(meanX) + 4} y={padding + 12} fill={theme.colors.blue} fontSize=\"10\">Î¼x</text>\n                <text x={padding + 4} y={toPlotY(meanY) - 4} fill={theme.colors.blue} fontSize=\"10\">Î¼y</text>\n              </>\n            )}\n            \n            {/* Deviation lines (step 2) */}\n            {step >= 2 && points.map((p, i) => (\n              <g key={`dev-${i}`}>\n                <line x1={toPlotX(meanX)} y1={toPlotY(p[1])} x2={toPlotX(p[0])} y2={toPlotY(p[1])} \n                  stroke={theme.colors.yellow} strokeWidth=\"1\" opacity=\"0.5\" />\n                <line x1={toPlotX(p[0])} y1={toPlotY(meanY)} x2={toPlotX(p[0])} y2={toPlotY(p[1])} \n                  stroke={theme.colors.yellow} strokeWidth=\"1\" opacity=\"0.5\" />\n              </g>\n            ))}\n            \n            {/* Points */}\n            {points.map((p, i) => (\n              <g key={i}>\n                <circle cx={toPlotX(p[0])} cy={toPlotY(p[1])} r=\"12\"\n                  fill={theme.colors.pink} stroke={theme.colors.text} strokeWidth=\"2\"\n                  style={{ cursor: 'grab' }}\n                  onMouseDown={() => setDragging(i)} />\n                <text x={toPlotX(p[0])} y={toPlotY(p[1]) + 4} textAnchor=\"middle\" \n                  fill={theme.colors.background} fontSize=\"10\" fontWeight=\"bold\"\n                  style={{ pointerEvents: 'none' }}>\n                  {i}\n                </text>\n              </g>\n            ))}\n            \n            {/* Axis labels */}\n            <text x={plotSize / 2} y={plotSize - 4} textAnchor=\"middle\" fill={theme.colors.textMuted} fontSize=\"11\">X</text>\n            <text x={8} y={plotSize / 2} textAnchor=\"middle\" fill={theme.colors.textMuted} fontSize=\"11\" \n              transform={`rotate(-90, 8, ${plotSize / 2})`}>Y</text>\n          </svg>\n          \n          {/* Live correlation display */}\n          <div style={{ marginTop: '12px', padding: '12px', background: theme.colors.surfaceAlt, borderRadius: '8px', textAlign: 'center' }}>\n            <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginBottom: '4px' }}>Correlation r</div>\n            <div style={{ fontSize: '28px', fontWeight: '700', color: getCorrColor(corr) }}>\n              {step >= 3 ? corr.toFixed(3) : '?'}\n            </div>\n            {step >= 3 && (\n              <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginTop: '4px' }}>\n                {corr > 0.9 ? 'Strong positive â†—' : corr > 0.5 ? 'Moderate positive' : \n                 corr > -0.5 ? 'Weak / none' : corr > -0.9 ? 'Moderate negative' : 'Strong negative â†˜'}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Right: Data and calculations */}\n        <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '12px' }}>\n          \n          {/* Data table */}\n          <div style={{ background: theme.colors.surface, borderRadius: '12px', padding: '14px' }}>\n            <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginBottom: '8px' }}>\n              Data ({n} points)\n            </div>\n            <div style={{ display: 'flex', gap: '8px' }}>\n              {/* X column */}\n              <div>\n                <div style={{ fontSize: '11px', color: theme.colors.blue, marginBottom: '4px', textAlign: 'center' }}>X</div>\n                {points.map((p, i) => (\n                  <div key={i} style={{\n                    width: '40px', height: '24px', marginBottom: '2px', borderRadius: '4px',\n                    background: theme.colors.surfaceAlt, border: `1px solid ${theme.colors.border}`,\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    fontSize: '12px', color: theme.colors.text,\n                  }}>{p[0]}</div>\n                ))}\n                {step >= 1 && (\n                  <div style={{\n                    width: '40px', height: '24px', marginTop: '4px', borderRadius: '4px',\n                    background: theme.colors.blue + '30', border: `1px solid ${theme.colors.blue}`,\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    fontSize: '11px', fontWeight: '600', color: theme.colors.blue,\n                  }}>{meanX.toFixed(1)}</div>\n                )}\n              </div>\n              \n              {/* Y column */}\n              <div>\n                <div style={{ fontSize: '11px', color: theme.colors.blue, marginBottom: '4px', textAlign: 'center' }}>Y</div>\n                {points.map((p, i) => (\n                  <div key={i} style={{\n                    width: '40px', height: '24px', marginBottom: '2px', borderRadius: '4px',\n                    background: theme.colors.surfaceAlt, border: `1px solid ${theme.colors.border}`,\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    fontSize: '12px', color: theme.colors.text,\n                  }}>{p[1]}</div>\n                ))}\n                {step >= 1 && (\n                  <div style={{\n                    width: '40px', height: '24px', marginTop: '4px', borderRadius: '4px',\n                    background: theme.colors.blue + '30', border: `1px solid ${theme.colors.blue}`,\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    fontSize: '11px', fontWeight: '600', color: theme.colors.blue,\n                  }}>{meanY.toFixed(1)}</div>\n                )}\n              </div>\n              \n              {/* Centered values */}\n              {step >= 2 && (\n                <>\n                  <div style={{ width: '1px', background: theme.colors.border, margin: '0 4px' }} />\n                  <div>\n                    <div style={{ fontSize: '11px', color: theme.colors.yellow, marginBottom: '4px', textAlign: 'center' }}>Xâˆ’Î¼</div>\n                    {centered.map((p, i) => (\n                      <div key={i} style={{\n                        width: '44px', height: '24px', marginBottom: '2px', borderRadius: '4px',\n                        background: theme.colors.yellow + '15', border: `1px solid ${theme.colors.yellow}40`,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center',\n                        fontSize: '11px', color: theme.colors.yellow,\n                      }}>{p[0] > 0 ? '+' : ''}{p[0].toFixed(1)}</div>\n                    ))}\n                  </div>\n                  <div>\n                    <div style={{ fontSize: '11px', color: theme.colors.yellow, marginBottom: '4px', textAlign: 'center' }}>Yâˆ’Î¼</div>\n                    {centered.map((p, i) => (\n                      <div key={i} style={{\n                        width: '44px', height: '24px', marginBottom: '2px', borderRadius: '4px',\n                        background: theme.colors.yellow + '15', border: `1px solid ${theme.colors.yellow}40`,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center',\n                        fontSize: '11px', color: theme.colors.yellow,\n                      }}>{p[1] > 0 ? '+' : ''}{p[1].toFixed(1)}</div>\n                    ))}\n                  </div>\n                  <div>\n                    <div style={{ fontSize: '11px', color: theme.colors.pink, marginBottom: '4px', textAlign: 'center' }}>Ã—</div>\n                    {centered.map((p, i) => (\n                      <div key={i} style={{\n                        width: '48px', height: '24px', marginBottom: '2px', borderRadius: '4px',\n                        background: p[0] * p[1] > 0 ? theme.colors.green + '20' : theme.colors.red + '20',\n                        border: `1px solid ${p[0] * p[1] > 0 ? theme.colors.green : theme.colors.red}40`,\n                        display: 'flex', alignItems: 'center', justifyContent: 'center',\n                        fontSize: '11px', color: p[0] * p[1] > 0 ? theme.colors.green : theme.colors.red,\n                      }}>{(p[0] * p[1]).toFixed(1)}</div>\n                    ))}\n                    <div style={{\n                      width: '48px', height: '24px', marginTop: '4px', borderRadius: '4px',\n                      background: cov > 0 ? theme.colors.green + '30' : theme.colors.red + '30',\n                      border: `1px solid ${cov > 0 ? theme.colors.green : theme.colors.red}`,\n                      display: 'flex', alignItems: 'center', justifyContent: 'center',\n                      fontSize: '11px', fontWeight: '700', color: cov > 0 ? theme.colors.green : theme.colors.red,\n                    }}>Î£/{n}</div>\n                  </div>\n                </>\n              )}\n            </div>\n          </div>\n\n          {/* Formula breakdown */}\n          {step >= 3 && (\n            <div style={{ background: theme.colors.surface, borderRadius: '12px', padding: '14px' }}>\n              <div style={{ fontSize: '11px', color: theme.colors.green, fontWeight: '600', marginBottom: '10px' }}>\n                Final Calculation\n              </div>\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '8px', fontSize: '13px' }}>\n                <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                  <span style={{ color: theme.colors.textMuted, width: '70px' }}>cov(X,Y)</span>\n                  <span style={{ color: theme.colors.yellow }}>{cov.toFixed(3)}</span>\n                </div>\n                <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                  <span style={{ color: theme.colors.textMuted, width: '70px' }}>Ïƒx Ã— Ïƒy</span>\n                  <span style={{ color: theme.colors.blue }}>{stdX.toFixed(2)} Ã— {stdY.toFixed(2)} = {(stdX * stdY).toFixed(3)}</span>\n                </div>\n                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', paddingTop: '8px', borderTop: `1px solid ${theme.colors.border}` }}>\n                  <span style={{ color: theme.colors.textMuted, width: '70px' }}>r =</span>\n                  <span style={{ color: getCorrColor(corr), fontWeight: '700', fontSize: '16px' }}>{corr.toFixed(3)}</span>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Key Insight */}\n      <div style={{ background: theme.colors.surfaceAlt, borderRadius: '8px', padding: '10px 14px', marginTop: '12px',\n        fontSize: '12px', color: theme.colors.textSecondary, borderLeft: `4px solid ${theme.colors.primary}` }}>\n        <span style={{ color: theme.colors.primary, fontWeight: '600' }}>ðŸ’¡ </span>\n        {step === 0 && 'Drag the points around! See how their arrangement affects correlation. Upward trend = positive, downward = negative.'}\n        {step === 1 && 'Dashed lines show the means. The mean is the \"center\" of each variable.'}\n        {step === 2 && 'Centered values show distance from mean. Product column: positive Ã— positive or negative Ã— negative = positive contribution to correlation.'}\n        {step === 3 && 'Divide covariance by (Ïƒx Ã— Ïƒy) to normalize. Result is always between âˆ’1 and +1. Try dragging points to see r change!'}\n      </div>\n    </div>\n  );\n}",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showEditor": false,
    "editorWidthPercentage": 35,
    "showConsole": false
  },
  "dependencies": {}
}