{
  "problem_id": 13,
  "title": "Determinant of a 4x4 Matrix using Laplace's Expansion (hard)",
  "category": "Linear Algebra",
  "enabled": true,
  "type": "react",
  "code": "import React, { useState, useMemo } from 'react';\n\n// ============================================\n// Design Tokens\n// ============================================\nconst theme = {\n  colors: {\n    primary: '#8b5cf6',\n    background: '#0a0a0a',\n    surface: '#111111',\n    surfaceAlt: '#1a1a1a',\n    border: '#2a2a2a',\n    text: '#fafafa',\n    textSecondary: '#a1a1aa',\n    textMuted: '#52525b',\n    positive: '#10b981',\n    negative: '#f43f5e',\n    blue: '#38bdf8',\n    yellow: '#fbbf24',\n    pink: '#f472b6',\n    green: '#a3e635',\n  },\n  font: \"'JetBrains Mono', monospace\",\n};\n\nconst termColors = ['#f472b6', '#38bdf8', '#a3e635', '#fbbf24'];\n\n// ============================================\n// Determinant Calculation\n// ============================================\nfunction det3x3(m) {\n  return (\n    m[0][0] * (m[1][1] * m[2][2] - m[1][2] * m[2][1]) -\n    m[0][1] * (m[1][0] * m[2][2] - m[1][2] * m[2][0]) +\n    m[0][2] * (m[1][0] * m[2][1] - m[1][1] * m[2][0])\n  );\n}\n\nfunction getMinor(matrix, skipRow, skipCol) {\n  const minor = [];\n  for (let i = 0; i < matrix.length; i++) {\n    if (i === skipRow) continue;\n    const row = [];\n    for (let j = 0; j < matrix[i].length; j++) {\n      if (j === skipCol) continue;\n      row.push(matrix[i][j]);\n    }\n    minor.push(row);\n  }\n  return minor;\n}\n\n// ============================================\n// Matrix Display with Highlighting\n// ============================================\nfunction MatrixDisplay({ matrix, highlightRow, highlightCol, crossedOut, small, color }) {\n  const size = matrix.length;\n  const cellSize = small ? '24px' : '34px';\n  const fontSize = small ? '10px' : '12px';\n  \n  return (\n    <div style={{\n      display: 'inline-flex',\n      alignItems: 'center',\n      padding: small ? '4px' : '8px',\n      background: color ? `${color}10` : theme.colors.surface,\n      borderRadius: '8px',\n      border: `1px solid ${color || theme.colors.border}40`,\n    }}>\n      <span style={{ color: color || theme.colors.textMuted, fontSize: small ? '18px' : '28px', fontWeight: '200' }}>[</span>\n      <div style={{ display: 'flex', flexDirection: 'column', gap: '2px' }}>\n        {matrix.map((row, i) => (\n          <div key={i} style={{ display: 'flex', gap: '2px' }}>\n            {row.map((val, j) => {\n              const isCrossed = crossedOut && (i === highlightRow || j === highlightCol);\n              const isHighlighted = !crossedOut && i === highlightRow && j === highlightCol;\n              const isInMinor = crossedOut && i !== highlightRow && j !== highlightCol;\n              \n              return (\n                <div\n                  key={j}\n                  style={{\n                    width: cellSize,\n                    height: cellSize,\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize,\n                    fontWeight: isHighlighted ? '700' : '500',\n                    color: isCrossed ? theme.colors.textMuted : isHighlighted ? termColors[j] : theme.colors.text,\n                    background: isHighlighted ? `${termColors[j]}30` : isInMinor ? `${theme.colors.primary}15` : 'transparent',\n                    borderRadius: '4px',\n                    textDecoration: isCrossed ? 'line-through' : 'none',\n                    opacity: isCrossed ? 0.3 : 1,\n                    transition: 'all 0.2s',\n                  }}\n                >\n                  {val}\n                </div>\n              );\n            })}\n          </div>\n        ))}\n      </div>\n      <span style={{ color: color || theme.colors.textMuted, fontSize: small ? '18px' : '28px', fontWeight: '200' }}>]</span>\n    </div>\n  );\n}\n\n// ============================================\n// Term Card\n// ============================================\nfunction TermCard({ element, sign, minorDet, col, isActive }) {\n  const color = termColors[col];\n  const result = sign * element * minorDet;\n  \n  return (\n    <div style={{\n      padding: '8px',\n      background: isActive ? `${color}15` : theme.colors.surface,\n      borderRadius: '6px',\n      border: `1px solid ${isActive ? color : theme.colors.border}`,\n      textAlign: 'center',\n      opacity: isActive ? 1 : 0.4,\n      transition: 'all 0.2s',\n    }}>\n      <div style={{ fontSize: '9px', color: theme.colors.textMuted, marginBottom: '2px' }}>\n        Term {col + 1}\n      </div>\n      <div style={{ fontSize: '11px', color: theme.colors.textSecondary }}>\n        <span style={{ color: sign > 0 ? theme.colors.positive : theme.colors.negative }}>{sign > 0 ? '+' : '-'}</span>\n        <span style={{ color, fontWeight: '600' }}>{Math.abs(element)}</span>\n        <span style={{ color: theme.colors.textMuted }}> x </span>\n        <span>{minorDet}</span>\n      </div>\n      <div style={{ fontSize: '12px', fontWeight: '700', color, marginTop: '2px' }}>\n        = {result}\n      </div>\n    </div>\n  );\n}\n\n// ============================================\n// Main App\n// ============================================\nexport default function DeterminantPlayground() {\n  const [exampleIdx, setExampleIdx] = useState(0);\n  const [step, setStep] = useState(0);\n  const [playing, setPlaying] = useState(false);\n  \n  const examples = [\n    { name: 'Singular', matrix: [[1,2,3,4], [5,6,7,8], [9,10,11,12], [13,14,15,16]] },\n    { name: 'Non-zero', matrix: [[4,3,2,1], [3,2,1,4], [2,1,4,3], [1,4,3,2]] },\n    { name: 'Identity', matrix: [[1,0,0,0], [0,1,0,0], [0,0,1,0], [0,0,0,1]] },\n  ];\n  \n  const matrix = examples[exampleIdx].matrix;\n  \n  const terms = useMemo(() => {\n    return [0, 1, 2, 3].map(j => {\n      const sign = j % 2 === 0 ? 1 : -1;\n      const minor = getMinor(matrix, 0, j);\n      const minorDet = det3x3(minor);\n      return {\n        col: j,\n        element: matrix[0][j],\n        sign,\n        minor,\n        minorDet,\n        contribution: sign * matrix[0][j] * minorDet,\n      };\n    });\n  }, [matrix]);\n  \n  const finalDet = terms.reduce((sum, t) => sum + t.contribution, 0);\n  const totalSteps = 5;\n  const currentTerm = step >= 1 && step <= 4 ? terms[step - 1] : null;\n  \n  const reset = () => { setStep(0); setPlaying(false); };\n  const next = () => step < totalSteps && setStep(step + 1);\n  const prev = () => step > 0 && setStep(step - 1);\n  \n  const auto = async () => {\n    setPlaying(true);\n    for (let s = 0; s <= totalSteps; s++) {\n      setStep(s);\n      await new Promise(r => setTimeout(r, 1000));\n    }\n    setPlaying(false);\n  };\n\n  const stepInfo = [\n    { title: \"Laplace Expansion\", desc: \"Expand along the first row. For each element, cross out its row and column to get a 3x3 minor.\", color: theme.colors.primary },\n    { title: \"Term 1: First Element\", desc: `Element ${matrix[0][0]} with + sign. Cross out row 1, column 1.`, color: termColors[0] },\n    { title: \"Term 2: Second Element\", desc: `Element ${matrix[0][1]} with - sign. Cross out row 1, column 2.`, color: termColors[1] },\n    { title: \"Term 3: Third Element\", desc: `Element ${matrix[0][2]} with + sign. Cross out row 1, column 3.`, color: termColors[2] },\n    { title: \"Term 4: Fourth Element\", desc: `Element ${matrix[0][3]} with - sign. Cross out row 1, column 4.`, color: termColors[3] },\n    { title: \"Final Result\", desc: `Add all four terms together to get the determinant.`, color: theme.colors.positive },\n  ];\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: theme.colors.background,\n      color: theme.colors.text,\n      fontFamily: theme.font,\n      padding: '16px',\n    }}>\n      <div style={{ maxWidth: '480px', margin: '0 auto' }}>\n        {/* Header */}\n        <div style={{ textAlign: 'center', marginBottom: '16px' }}>\n          <h1 style={{ fontSize: '18px', fontWeight: '700', margin: 0 }}>4x4 Determinant</h1>\n          <p style={{ color: theme.colors.textSecondary, fontSize: '11px', marginTop: '4px' }}>\n            Laplace Expansion along first row\n          </p>\n        </div>\n        \n        {/* Example Tabs */}\n        <div style={{ display: 'flex', gap: '6px', justifyContent: 'center', marginBottom: '16px' }}>\n          {examples.map((e, idx) => (\n            <button\n              key={idx}\n              onClick={() => { setExampleIdx(idx); reset(); }}\n              style={{\n                padding: '6px 12px',\n                background: exampleIdx === idx ? theme.colors.primary : theme.colors.surface,\n                border: 'none',\n                borderRadius: '6px',\n                color: exampleIdx === idx ? '#fff' : theme.colors.textSecondary,\n                fontFamily: theme.font,\n                fontSize: '11px',\n                cursor: 'pointer',\n              }}\n            >\n              {e.name}\n            </button>\n          ))}\n        </div>\n        \n        {/* Main Card */}\n        <div style={{ background: theme.colors.surfaceAlt, borderRadius: '12px', padding: '16px' }}>\n          \n          {/* Matrix Display */}\n          <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '12px' }}>\n            <MatrixDisplay\n              matrix={matrix}\n              highlightRow={currentTerm ? 0 : -1}\n              highlightCol={currentTerm ? currentTerm.col : -1}\n              crossedOut={currentTerm !== null}\n            />\n          </div>\n          \n          {/* Step Explanation */}\n          <div style={{\n            padding: '10px 12px',\n            background: theme.colors.surface,\n            borderRadius: '8px',\n            borderLeft: `3px solid ${stepInfo[step].color}`,\n            marginBottom: '12px',\n          }}>\n            <div style={{ fontSize: '12px', fontWeight: '600', color: theme.colors.text, marginBottom: '2px' }}>\n              {stepInfo[step].title}\n            </div>\n            <div style={{ fontSize: '11px', color: theme.colors.textSecondary, lineHeight: 1.4 }}>\n              {stepInfo[step].desc}\n            </div>\n          </div>\n          \n          {/* Step Indicator */}\n          <div style={{ display: 'flex', gap: '4px', justifyContent: 'center', marginBottom: '12px' }}>\n            {Array.from({ length: totalSteps + 1 }).map((_, i) => (\n              <div\n                key={i}\n                onClick={() => setStep(i)}\n                style={{\n                  width: i === step ? '20px' : '8px',\n                  height: '8px',\n                  borderRadius: '4px',\n                  background: i <= step ? theme.colors.primary : theme.colors.border,\n                  cursor: 'pointer',\n                  transition: 'all 0.3s',\n                }}\n              />\n            ))}\n          </div>\n          \n          {/* Controls - RIGHT AFTER STEP INFO */}\n          <div style={{ display: 'flex', gap: '8px', alignItems: 'center', marginBottom: '16px' }}>\n            <button onClick={prev} disabled={step <= 0} style={{\n              padding: '10px 14px',\n              background: theme.colors.surface,\n              border: 'none',\n              borderRadius: '8px',\n              color: step <= 0 ? theme.colors.textMuted : theme.colors.text,\n              cursor: step <= 0 ? 'not-allowed' : 'pointer',\n              fontSize: '14px',\n            }}>\n              ←\n            </button>\n            \n            <button onClick={next} disabled={step >= totalSteps} style={{\n              flex: 1,\n              padding: '12px',\n              background: step < totalSteps ? theme.colors.primary : theme.colors.positive,\n              border: 'none',\n              borderRadius: '8px',\n              color: '#fff',\n              fontFamily: theme.font,\n              fontSize: '12px',\n              fontWeight: '600',\n              cursor: step < totalSteps ? 'pointer' : 'default',\n            }}>\n              {step === 0 ? 'Start' : step < totalSteps ? 'Next Term' : 'Complete'}\n            </button>\n            \n            <button onClick={auto} disabled={playing || step >= totalSteps} style={{\n              padding: '10px 14px',\n              background: theme.colors.surface,\n              border: 'none',\n              borderRadius: '8px',\n              color: playing || step >= totalSteps ? theme.colors.textMuted : theme.colors.text,\n              cursor: playing || step >= totalSteps ? 'not-allowed' : 'pointer',\n              fontSize: '12px',\n            }}>\n              ▶▶\n            </button>\n            \n            <button onClick={reset} style={{\n              padding: '10px 14px',\n              background: theme.colors.surface,\n              border: 'none',\n              borderRadius: '8px',\n              color: theme.colors.text,\n              cursor: 'pointer',\n              fontSize: '14px',\n            }}>\n              ↺\n            </button>\n          </div>\n          \n          {/* ============ MATH INFO BELOW CONTROLS ============ */}\n          \n          {/* Current Minor - only show when on term steps */}\n          {currentTerm && (\n            <div style={{\n              padding: '12px',\n              background: theme.colors.surface,\n              borderRadius: '8px',\n              marginBottom: '12px',\n            }}>\n              <div style={{ fontSize: '9px', color: theme.colors.textMuted, marginBottom: '8px', textAlign: 'center' }}>\n                3x3 MINOR (after crossing out row 1, col {currentTerm.col + 1})\n              </div>\n              <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', gap: '16px' }}>\n                <MatrixDisplay\n                  matrix={currentTerm.minor}\n                  small\n                  color={termColors[currentTerm.col]}\n                />\n                <div style={{ textAlign: 'center' }}>\n                  <div style={{ fontSize: '9px', color: theme.colors.textMuted }}>det =</div>\n                  <div style={{ fontSize: '20px', fontWeight: '700', color: theme.colors.text }}>\n                    {currentTerm.minorDet}\n                  </div>\n                </div>\n              </div>\n              \n              {/* Current term calculation */}\n              <div style={{\n                marginTop: '12px',\n                padding: '10px',\n                background: `${termColors[currentTerm.col]}15`,\n                borderRadius: '6px',\n                textAlign: 'center',\n              }}>\n                <div style={{ fontSize: '11px', color: theme.colors.textSecondary }}>\n                  <span style={{ color: currentTerm.sign > 0 ? theme.colors.positive : theme.colors.negative }}>\n                    {currentTerm.sign > 0 ? '+' : '-'}\n                  </span>\n                  {' '}\n                  <span style={{ color: termColors[currentTerm.col], fontWeight: '600' }}>{Math.abs(currentTerm.element)}</span>\n                  {' x '}\n                  <span>{currentTerm.minorDet}</span>\n                  {' = '}\n                  <span style={{ color: termColors[currentTerm.col], fontWeight: '700', fontSize: '14px' }}>\n                    {currentTerm.contribution}\n                  </span>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {/* All Terms Summary - show after step 1 */}\n          {step >= 1 && (\n            <div style={{ marginBottom: '12px' }}>\n              <div style={{ fontSize: '9px', color: theme.colors.textMuted, marginBottom: '6px', textAlign: 'center' }}>\n                ALL TERMS (signs alternate: +, -, +, -)\n              </div>\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '6px' }}>\n                {terms.map((t, i) => (\n                  <TermCard\n                    key={i}\n                    element={t.element}\n                    sign={t.sign}\n                    minorDet={t.minorDet}\n                    col={t.col}\n                    isActive={step > i}\n                  />\n                ))}\n              </div>\n            </div>\n          )}\n          \n          {/* Final Result - show after step 1 */}\n          {step >= 1 && (\n            <div style={{\n              padding: '12px',\n              background: step === totalSteps ? `${theme.colors.positive}15` : theme.colors.surface,\n              borderRadius: '8px',\n              textAlign: 'center',\n              border: `1px solid ${step === totalSteps ? theme.colors.positive : theme.colors.border}`,\n            }}>\n              <div style={{ fontSize: '9px', color: theme.colors.textMuted, marginBottom: '4px' }}>\n                DETERMINANT\n              </div>\n              <div style={{ fontSize: '11px', color: theme.colors.textSecondary, marginBottom: '4px' }}>\n                {terms.map((t, i) => (\n                  <span key={i}>\n                    {i > 0 && ' + '}\n                    <span style={{ color: step > i ? termColors[i] : theme.colors.textMuted }}>\n                      ({t.contribution})\n                    </span>\n                  </span>\n                ))}\n              </div>\n              <div style={{\n                fontSize: '28px',\n                fontWeight: '700',\n                color: step === totalSteps ? theme.colors.positive : theme.colors.text,\n              }}>\n                = {finalDet}\n              </div>\n            </div>\n          )}\n        </div>\n        \n        {/* Key Insight */}\n        <div style={{\n          marginTop: '12px',\n          padding: '10px 14px',\n          background: theme.colors.surface,\n          borderRadius: '8px',\n          fontSize: '10px',\n          color: theme.colors.textSecondary,\n          textAlign: 'center',\n        }}>\n          <strong style={{ color: theme.colors.text }}>Pattern:</strong> Signs alternate +, -, +, - along the row. \n          Each minor is computed recursively until reaching 2x2 matrices.\n        </div>\n      </div>\n    </div>\n  );\n}",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showEditor": false,
    "editorWidthPercentage": 35,
    "showConsole": false
  },
  "dependencies": {}
}