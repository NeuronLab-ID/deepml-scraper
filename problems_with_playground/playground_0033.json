{
  "problem_id": 33,
  "title": "Generate Random Subsets of a Dataset",
  "category": "Machine Learning",
  "enabled": true,
  "type": "react",
  "code": "import React, { useState, useEffect, useMemo } from 'react';\n\nconst theme = {\n  colors: {\n    primary: '#8b5cf6',\n    background: '#0a0a0a',\n    surface: '#111111',\n    surfaceAlt: '#1a1a1a',\n    border: '#2a2a2a',\n    text: '#fafafa',\n    textSecondary: '#a1a1aa',\n    textMuted: '#52525b',\n    blue: '#38bdf8',\n    yellow: '#fbbf24',\n    pink: '#f472b6',\n    green: '#a3e635',\n    orange: '#fb923c',\n  },\n  font: \"'JetBrains Mono', monospace\",\n};\n\nconst sampleColors = ['#38bdf8', '#a3e635', '#f472b6', '#fbbf24', '#fb923c'];\n\n// Seeded random\nconst seededRandom = (seed) => {\n  let s = seed;\n  return () => {\n    s = (s * 1103515245 + 12345) & 0x7fffffff;\n    return s / 0x7fffffff;\n  };\n};\n\nexport default function App() {\n  const [step, setStep] = useState(0);\n  const [playing, setPlaying] = useState(false);\n  const [withReplacement, setWithReplacement] = useState(true);\n  const [subsetSize, setSubsetSize] = useState(4);\n  const [seed, setSeed] = useState(42);\n  const [pickStep, setPickStep] = useState(0);\n\n  // Original data\n  const X = [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]];\n  const y = [1, 2, 3, 4, 5];\n  const n = X.length;\n\n  // Max subset size depends on replacement mode\n  const maxSize = withReplacement ? 8 : n;\n\n  // Clamp subset size when switching modes\n  useEffect(() => {\n    if (!withReplacement && subsetSize > n) {\n      setSubsetSize(n);\n    }\n  }, [withReplacement, subsetSize]);\n\n  const numSteps = 4;\n\n  // Generate the sequence of picks\n  const picks = useMemo(() => {\n    const rand = seededRandom(seed);\n    const result = [];\n    const available = [...Array(n).keys()]; // [0,1,2,3,4]\n    \n    for (let i = 0; i < subsetSize; i++) {\n      if (withReplacement) {\n        const picked = Math.floor(rand() * n);\n        result.push({ picked, available: [...Array(n).keys()], poolAfter: [...Array(n).keys()] });\n      } else {\n        const poolBefore = [...available];\n        const j = Math.floor(rand() * available.length);\n        const picked = available[j];\n        available.splice(j, 1);\n        result.push({ picked, available: poolBefore, poolAfter: [...available] });\n      }\n    }\n    return result;\n  }, [seed, withReplacement, subsetSize]);\n\n  // Current state based on pickStep\n  const currentPicks = picks.slice(0, pickStep);\n  const currentPool = pickStep === 0 \n    ? [...Array(n).keys()] \n    : (pickStep <= picks.length ? picks[pickStep - 1].poolAfter : picks[picks.length - 1].poolAfter);\n\n  const stepInfo = [\n    { title: 'The Pool', desc: `${n} samples available to pick from`, color: theme.colors.primary },\n    { title: 'Configure', desc: `Pick ${subsetSize} samples ${withReplacement ? 'WITH' : 'WITHOUT'} replacement`, color: theme.colors.blue },\n    { title: 'Pick Samples', desc: `Pick ${pickStep}/${subsetSize} - ${withReplacement ? 'sample returns to pool' : 'sample removed from pool'}`, color: theme.colors.yellow },\n    { title: 'Subset Complete', desc: `Subset has ${subsetSize} samples`, color: theme.colors.green },\n  ];\n\n  // Auto-advance picking in step 2\n  useEffect(() => {\n    if (step === 2 && pickStep < subsetSize) {\n      const timer = setTimeout(() => {\n        setPickStep(p => p + 1);\n      }, 700);\n      return () => clearTimeout(timer);\n    }\n  }, [step, pickStep, subsetSize]);\n\n  useEffect(() => {\n    if (step !== 2) setPickStep(0);\n    if (step === 3) setPickStep(subsetSize);\n  }, [step, subsetSize]);\n\n  const play = async () => {\n    setPlaying(true);\n    setPickStep(0);\n    for (let s = 0; s < numSteps; s++) {\n      setStep(s);\n      if (s === 2) {\n        await new Promise(r => setTimeout(r, subsetSize * 700 + 500));\n      } else {\n        await new Promise(r => setTimeout(r, 1500));\n      }\n    }\n    setPlaying(false);\n  };\n\n  const reset = () => { \n    setStep(0); \n    setPlaying(false); \n    setWithReplacement(true); \n    setSubsetSize(4);\n    setSeed(42); \n    setPickStep(0); \n  };\n\n  // Count occurrences in current picks\n  const getCounts = () => {\n    const counts = {};\n    currentPicks.forEach(p => { counts[p.picked] = (counts[p.picked] || 0) + 1; });\n    return counts;\n  };\n  const counts = getCounts();\n\n  return (\n    <div style={{ background: theme.colors.background, minHeight: '100vh', padding: '12px', fontFamily: theme.font, color: theme.colors.text }}>\n      \n      {/* Header */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '10px' }}>\n        <div>\n          <div style={{ fontSize: '18px', fontWeight: '700' }}>Random Subsets</div>\n          <div style={{ fontSize: '12px', color: theme.colors.textSecondary }}>Bootstrap sampling for ensemble methods</div>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n          <button onClick={() => setStep(Math.max(0, step - 1))} disabled={step === 0}\n            style={{ padding: '6px 12px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: step === 0 ? theme.colors.textMuted : theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'<'}</button>\n          <div style={{ display: 'flex', gap: '5px' }}>\n            {Array.from({ length: numSteps }, (_, i) => (\n              <div key={i} onClick={() => setStep(i)} style={{\n                width: i === step ? '18px' : '10px', height: '10px', borderRadius: '5px',\n                background: i <= step ? stepInfo[i].color : theme.colors.border, cursor: 'pointer'\n              }} />\n            ))}\n          </div>\n          <button onClick={() => setStep(Math.min(numSteps - 1, step + 1))} disabled={step === numSteps - 1}\n            style={{ padding: '6px 12px', background: step === numSteps - 1 ? theme.colors.surface : theme.colors.primary,\n              border: 'none', borderRadius: '6px', color: theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'>'}</button>\n          <button onClick={play} disabled={playing}\n            style={{ padding: '6px 12px', background: playing ? theme.colors.green : theme.colors.surface,\n              border: 'none', borderRadius: '6px', color: playing ? theme.colors.background : theme.colors.text,\n              fontSize: '12px', cursor: 'pointer' }}>{playing ? '...' : 'Play'}</button>\n          <button onClick={reset}\n            style={{ padding: '6px 10px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: theme.colors.textSecondary, fontSize: '14px', cursor: 'pointer' }}>~</button>\n        </div>\n      </div>\n\n      {/* Step info */}\n      <div style={{ padding: '8px 12px', background: theme.colors.surface, borderLeft: `3px solid ${stepInfo[step].color}`,\n        borderRadius: '0 6px 6px 0', marginBottom: '12px' }}>\n        <span style={{ fontWeight: '600', color: stepInfo[step].color, fontSize: '14px' }}>{stepInfo[step].title}: </span>\n        <span style={{ color: theme.colors.textSecondary, fontSize: '13px' }}>{stepInfo[step].desc}</span>\n      </div>\n\n      <div style={{ display: 'flex', gap: '20px', marginBottom: '12px' }}>\n        \n        {/* Left side - Pool */}\n        <div style={{ flex: 1 }}>\n          <div style={{ background: theme.colors.surface, borderRadius: '10px', padding: '16px' }}>\n            <div style={{ fontSize: '14px', color: theme.colors.textMuted, marginBottom: '12px', fontWeight: '600' }}>\n              Pool {withReplacement ? '(always full)' : `(${currentPool.length} remaining)`}\n            </div>\n            \n            {/* Pool visualization */}\n            <div style={{ \n              display: 'flex', gap: '10px', flexWrap: 'wrap', \n              padding: '20px', background: theme.colors.surfaceAlt, borderRadius: '8px',\n              minHeight: '80px', justifyContent: 'center', alignItems: 'center'\n            }}>\n              {[0, 1, 2, 3, 4].map(i => {\n                const inPool = withReplacement || currentPool.includes(i);\n                const justPicked = pickStep > 0 && picks[pickStep - 1]?.picked === i;\n                return (\n                  <div key={i} style={{\n                    width: '50px', height: '50px', borderRadius: '10px',\n                    background: inPool ? sampleColors[i] : theme.colors.border,\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    flexDirection: 'column',\n                    opacity: inPool ? 1 : 0.2,\n                    transform: justPicked ? 'scale(1.15)' : 'scale(1)',\n                    boxShadow: justPicked ? `0 0 20px ${sampleColors[i]}` : 'none',\n                    transition: 'all 0.3s ease',\n                  }}>\n                    <div style={{ fontSize: '18px', fontWeight: '700', color: theme.colors.background }}>{i}</div>\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Replacement indicator */}\n            <div style={{ \n              marginTop: '12px', padding: '10px', borderRadius: '6px',\n              background: withReplacement ? theme.colors.green + '20' : theme.colors.pink + '20',\n              border: `1px solid ${withReplacement ? theme.colors.green : theme.colors.pink}`,\n              textAlign: 'center', fontSize: '12px',\n            }}>\n              {withReplacement ? (\n                <span style={{ color: theme.colors.green }}>\n                  ↻ With Replacement: sample goes BACK to pool\n                </span>\n              ) : (\n                <span style={{ color: theme.colors.pink }}>\n                  ✗ Without Replacement: sample REMOVED from pool\n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Arrow */}\n        <div style={{ display: 'flex', alignItems: 'center' }}>\n          <div style={{ fontSize: '32px', color: step >= 2 ? theme.colors.yellow : theme.colors.textMuted }}>\n            →\n          </div>\n        </div>\n\n        {/* Right side - Subset being built */}\n        <div style={{ flex: 1 }}>\n          <div style={{ background: theme.colors.surface, borderRadius: '10px', padding: '16px' }}>\n            <div style={{ fontSize: '14px', color: theme.colors.textMuted, marginBottom: '12px', fontWeight: '600' }}>\n              Subset ({currentPicks.length}/{subsetSize} picked)\n            </div>\n            \n            {/* Subset slots */}\n            <div style={{ \n              display: 'flex', gap: '8px', flexWrap: 'wrap',\n              padding: '20px', background: theme.colors.surfaceAlt, borderRadius: '8px',\n              minHeight: '80px', alignItems: 'center',\n            }}>\n              {Array.from({ length: subsetSize }, (_, i) => {\n                const pick = currentPicks[i];\n                const isEmpty = !pick;\n                const isDuplicate = pick && counts[pick.picked] > 1;\n                \n                return (\n                  <div key={i} style={{\n                    width: '50px', height: '50px', borderRadius: '10px',\n                    background: isEmpty ? theme.colors.border : sampleColors[pick.picked],\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    flexDirection: 'column',\n                    border: isEmpty ? '2px dashed ' + theme.colors.textMuted : 'none',\n                    position: 'relative',\n                  }}>\n                    {!isEmpty && (\n                      <>\n                        <div style={{ fontSize: '18px', fontWeight: '700', color: theme.colors.background }}>\n                          {pick.picked}\n                        </div>\n                        {isDuplicate && (\n                          <div style={{\n                            position: 'absolute', top: '-6px', right: '-6px',\n                            background: theme.colors.orange, borderRadius: '50%',\n                            width: '18px', height: '18px', fontSize: '10px',\n                            display: 'flex', alignItems: 'center', justifyContent: 'center',\n                            color: theme.colors.background, fontWeight: '700',\n                          }}>\n                            {counts[pick.picked]}\n                          </div>\n                        )}\n                      </>\n                    )}\n                    {isEmpty && (\n                      <div style={{ fontSize: '12px', color: theme.colors.textMuted }}>?</div>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Picked sequence */}\n            {step >= 2 && currentPicks.length > 0 && (\n              <div style={{ marginTop: '12px', fontSize: '12px', color: theme.colors.textSecondary }}>\n                <span style={{ color: theme.colors.textMuted }}>indices = </span>\n                [{currentPicks.map(p => p.picked).join(', ')}]\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Controls */}\n      <div style={{ display: 'flex', gap: '12px', marginBottom: '12px' }}>\n        {/* Replacement toggle */}\n        <div style={{ flex: 1, background: theme.colors.surface, borderRadius: '8px', padding: '12px',\n          border: step === 1 ? `2px solid ${theme.colors.blue}` : `1px solid ${theme.colors.border}` }}>\n          <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginBottom: '8px' }}>replacement</div>\n          <div style={{ display: 'flex', gap: '8px' }}>\n            <button onClick={() => setWithReplacement(true)}\n              style={{\n                flex: 1, padding: '10px', borderRadius: '6px', border: 'none', cursor: 'pointer',\n                background: withReplacement ? theme.colors.green : theme.colors.surfaceAlt,\n                color: withReplacement ? theme.colors.background : theme.colors.textMuted,\n                fontSize: '12px', fontWeight: '600',\n              }}>\n              True\n            </button>\n            <button onClick={() => setWithReplacement(false)}\n              style={{\n                flex: 1, padding: '10px', borderRadius: '6px', border: 'none', cursor: 'pointer',\n                background: !withReplacement ? theme.colors.pink : theme.colors.surfaceAlt,\n                color: !withReplacement ? theme.colors.background : theme.colors.textMuted,\n                fontSize: '12px', fontWeight: '600',\n              }}>\n              False\n            </button>\n          </div>\n        </div>\n\n        {/* Subset size */}\n        <div style={{ flex: 1, background: theme.colors.surface, borderRadius: '8px', padding: '12px',\n          border: step === 1 ? `2px solid ${theme.colors.blue}` : `1px solid ${theme.colors.border}` }}>\n          <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginBottom: '6px' }}>\n            subset_size {!withReplacement && <span style={{ color: theme.colors.pink }}>(max {n})</span>}\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n            <input type=\"range\" min={1} max={maxSize} value={subsetSize} onChange={e => setSubsetSize(+e.target.value)}\n              style={{ flex: 1, accentColor: theme.colors.yellow }} />\n            <span style={{ fontSize: '18px', color: theme.colors.yellow, fontWeight: '700', width: '24px' }}>{subsetSize}</span>\n          </div>\n        </div>\n\n        {/* Seed */}\n        <div style={{ width: '140px', background: theme.colors.surface, borderRadius: '8px', padding: '12px' }}>\n          <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginBottom: '6px' }}>seed</div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n            <input type=\"range\" min={1} max={100} value={seed} onChange={e => setSeed(+e.target.value)}\n              style={{ flex: 1, accentColor: theme.colors.primary }} />\n            <span style={{ fontSize: '14px', color: theme.colors.primary, fontWeight: '600' }}>{seed}</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Key Insight */}\n      <div style={{ background: theme.colors.surfaceAlt, borderRadius: '8px', padding: '10px 14px',\n        fontSize: '12px', color: theme.colors.textSecondary, borderLeft: `3px solid ${theme.colors.primary}` }}>\n        <span style={{ color: theme.colors.primary, fontWeight: '600' }}>Key: </span>\n        {step === 0 && 'We have a pool of n=5 samples. To create a subset, we randomly pick samples from this pool.'}\n        {step === 1 && withReplacement \n          ? `WITH replacement: Pick ${subsetSize} samples. After each pick, sample returns to pool. Can pick same sample multiple times!`\n          : `WITHOUT replacement: Pick ${subsetSize} samples. After each pick, sample is removed. Max subset size = pool size (${n}).`}\n        {step === 2 && (pickStep < subsetSize \n          ? `Picking sample ${pickStep + 1}... Watch the ${withReplacement ? 'pool stay full' : 'pool shrink'}!`\n          : 'All samples picked!')}\n        {step === 3 && `Done! ${withReplacement && Object.values(counts).some(c => c > 1) ? 'Notice duplicates (orange badges) - this is bootstrap sampling. ' : ''}Create multiple subsets to train ensemble models like Random Forests.`}\n      </div>\n    </div>\n  );\n}",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showEditor": false,
    "editorWidthPercentage": 35,
    "showConsole": false
  },
  "dependencies": {}
}