{
  "problem_id": 30,
  "title": "Batch Iterator for Dataset",
  "category": "Machine Learning",
  "enabled": true,
  "type": "react",
  "code": "import React, { useState, useMemo, useEffect } from 'react';\n\nconst theme = {\n  colors: {\n    primary: '#8b5cf6',\n    background: '#0a0a0a',\n    surface: '#111111',\n    surfaceAlt: '#1a1a1a',\n    border: '#2a2a2a',\n    text: '#fafafa',\n    textSecondary: '#a1a1aa',\n    textMuted: '#52525b',\n    blue: '#38bdf8',\n    yellow: '#fbbf24',\n    pink: '#f472b6',\n    green: '#a3e635',\n    orange: '#fb923c',\n  },\n  font: \"'JetBrains Mono', monospace\",\n};\n\nconst batchColors = ['#38bdf8', '#a3e635', '#f472b6', '#fbbf24', '#fb923c'];\n\nexport default function App() {\n  const [step, setStep] = useState(0);\n  const [playing, setPlaying] = useState(false);\n  const [batchSize, setBatchSize] = useState(2);\n  const [currentBatch, setCurrentBatch] = useState(0);\n\n  // Sample data\n  const X = [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]];\n  const y = [1, 2, 3, 4, 5];\n  const n = X.length;\n\n  // Compute batches\n  const batches = useMemo(() => {\n    const result = [];\n    for (let i = 0; i < n; i += batchSize) {\n      const end = Math.min(i + batchSize, n);\n      result.push({\n        startIdx: i,\n        endIdx: end,\n        X: X.slice(i, end),\n        y: y.slice(i, end),\n      });\n    }\n    return result;\n  }, [batchSize]);\n\n  const numSteps = 4;\n\n  const stepInfo = [\n    { title: 'The Dataset', desc: `${n} samples. Each has features X and label y.`, color: theme.colors.primary },\n    { title: 'Set Batch Size', desc: `batch_size = ${batchSize} → ${batches.length} batches`, color: theme.colors.blue },\n    { title: 'Iterate Batches', desc: `Batch ${currentBatch + 1}/${batches.length}: indices [${batches[currentBatch]?.startIdx}:${batches[currentBatch]?.endIdx}]`, color: theme.colors.yellow },\n    { title: 'Result', desc: `List of ${batches.length} batches, each with [X_batch, y_batch]`, color: theme.colors.green },\n  ];\n\n  // Auto-cycle through batches in step 2\n  useEffect(() => {\n    if (step === 2) {\n      const interval = setInterval(() => {\n        setCurrentBatch(b => (b + 1) % batches.length);\n      }, 1200);\n      return () => clearInterval(interval);\n    } else {\n      setCurrentBatch(0);\n    }\n  }, [step, batches.length]);\n\n  const play = async () => {\n    setPlaying(true);\n    for (let s = 0; s < numSteps; s++) {\n      setStep(s);\n      await new Promise(r => setTimeout(r, s === 2 ? 3500 : 1800));\n    }\n    setPlaying(false);\n  };\n\n  const reset = () => { setStep(0); setPlaying(false); setBatchSize(2); setCurrentBatch(0); };\n\n  // Get batch index for a sample\n  const getBatchIdx = (sampleIdx) => Math.floor(sampleIdx / batchSize);\n\n  return (\n    <div style={{ background: theme.colors.background, minHeight: '100vh', padding: '12px', fontFamily: theme.font, color: theme.colors.text }}>\n      \n      {/* Header */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '10px' }}>\n        <div>\n          <div style={{ fontSize: '18px', fontWeight: '700' }}>Batch Iterator</div>\n          <div style={{ fontSize: '12px', color: theme.colors.textSecondary }}>Split data into mini-batches for training</div>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n          <button onClick={() => setStep(Math.max(0, step - 1))} disabled={step === 0}\n            style={{ padding: '6px 12px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: step === 0 ? theme.colors.textMuted : theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'<'}</button>\n          <div style={{ display: 'flex', gap: '5px' }}>\n            {Array.from({ length: numSteps }, (_, i) => (\n              <div key={i} onClick={() => setStep(i)} style={{\n                width: i === step ? '18px' : '10px', height: '10px', borderRadius: '5px',\n                background: i <= step ? stepInfo[i].color : theme.colors.border, cursor: 'pointer'\n              }} />\n            ))}\n          </div>\n          <button onClick={() => setStep(Math.min(numSteps - 1, step + 1))} disabled={step === numSteps - 1}\n            style={{ padding: '6px 12px', background: step === numSteps - 1 ? theme.colors.surface : theme.colors.primary,\n              border: 'none', borderRadius: '6px', color: theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'>'}</button>\n          <button onClick={play} disabled={playing}\n            style={{ padding: '6px 12px', background: playing ? theme.colors.green : theme.colors.surface,\n              border: 'none', borderRadius: '6px', color: playing ? theme.colors.background : theme.colors.text,\n              fontSize: '12px', cursor: 'pointer' }}>{playing ? '...' : 'Play'}</button>\n          <button onClick={reset}\n            style={{ padding: '6px 10px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: theme.colors.textSecondary, fontSize: '14px', cursor: 'pointer' }}>~</button>\n        </div>\n      </div>\n\n      {/* Step info */}\n      <div style={{ padding: '8px 12px', background: theme.colors.surface, borderLeft: `3px solid ${stepInfo[step].color}`,\n        borderRadius: '0 6px 6px 0', marginBottom: '12px' }}>\n        <span style={{ fontWeight: '600', color: stepInfo[step].color, fontSize: '14px' }}>{stepInfo[step].title}: </span>\n        <span style={{ color: theme.colors.textSecondary, fontSize: '13px' }}>{stepInfo[step].desc}</span>\n      </div>\n\n      <div style={{ display: 'flex', gap: '16px', marginBottom: '12px' }}>\n        \n        {/* Dataset visualization */}\n        <div style={{ flex: 1 }}>\n          <div style={{ fontSize: '13px', color: theme.colors.textMuted, marginBottom: '10px' }}>Dataset ({n} samples)</div>\n          \n          {/* Header row */}\n          <div style={{ display: 'flex', gap: '8px', marginBottom: '8px', paddingLeft: '36px' }}>\n            <div style={{ width: '100px', fontSize: '12px', color: theme.colors.blue, fontWeight: '600' }}>X (features)</div>\n            <div style={{ width: '50px', fontSize: '12px', color: theme.colors.pink, fontWeight: '600' }}>y</div>\n          </div>\n          \n          {/* Data rows */}\n          {X.map((row, i) => {\n            const batchIdx = getBatchIdx(i);\n            const color = batchColors[batchIdx % batchColors.length];\n            const isCurrentBatch = step === 2 && batchIdx === currentBatch;\n            const showBatch = step >= 1;\n            \n            return (\n              <div key={i} style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px',\n                padding: '10px 12px',\n                marginBottom: '4px',\n                borderRadius: '6px',\n                background: showBatch ? color + '15' : theme.colors.surface,\n                borderLeft: showBatch ? `4px solid ${color}` : `4px solid ${theme.colors.border}`,\n                transform: isCurrentBatch ? 'scale(1.02)' : 'scale(1)',\n                boxShadow: isCurrentBatch ? `0 0 12px ${color}50` : 'none',\n                transition: 'all 0.3s ease',\n              }}>\n                {/* Index */}\n                <div style={{ \n                  width: '24px', fontSize: '12px', color: theme.colors.textMuted, fontWeight: '600'\n                }}>\n                  [{i}]\n                </div>\n                \n                {/* X value */}\n                <div style={{ \n                  width: '100px', fontSize: '15px', fontWeight: '600',\n                  color: theme.colors.blue,\n                }}>\n                  [{row.join(', ')}]\n                </div>\n                \n                {/* y value */}\n                <div style={{ \n                  width: '50px', fontSize: '15px', fontWeight: '600',\n                  color: theme.colors.pink,\n                }}>\n                  {y[i]}\n                </div>\n                \n                {/* Batch label */}\n                {showBatch && (\n                  <div style={{\n                    marginLeft: 'auto',\n                    padding: '2px 8px',\n                    borderRadius: '10px',\n                    background: color,\n                    fontSize: '11px',\n                    fontWeight: '700',\n                    color: theme.colors.background,\n                  }}>\n                    Batch {batchIdx}\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Right panel */}\n        <div style={{ width: '220px', display: 'flex', flexDirection: 'column', gap: '10px' }}>\n          \n          {/* Batch size control */}\n          <div style={{ background: theme.colors.surface, borderRadius: '8px', padding: '12px',\n            border: step === 1 ? `2px solid ${theme.colors.blue}` : `1px solid ${theme.colors.border}` }}>\n            <div style={{ fontSize: '12px', color: theme.colors.textMuted, marginBottom: '8px' }}>\n              batch_size {step === 1 && <span style={{ color: theme.colors.blue }}>(adjust)</span>}\n            </div>\n            <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n              <input type=\"range\" min={1} max={4} value={batchSize} onChange={e => setBatchSize(+e.target.value)}\n                style={{ flex: 1, accentColor: theme.colors.blue }} />\n              <span style={{ fontSize: '18px', color: theme.colors.blue, fontWeight: '700', width: '24px' }}>{batchSize}</span>\n            </div>\n            <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginTop: '6px' }}>\n              {n} samples ÷ {batchSize} = {batches.length} batches\n              {n % batchSize !== 0 && <span style={{ color: theme.colors.orange }}> (last batch smaller)</span>}\n            </div>\n          </div>\n\n          {/* Batches overview */}\n          <div style={{ background: theme.colors.surface, borderRadius: '8px', padding: '12px' }}>\n            <div style={{ fontSize: '12px', color: theme.colors.textMuted, marginBottom: '10px' }}>Batches</div>\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '6px' }}>\n              {batches.map((batch, i) => {\n                const color = batchColors[i % batchColors.length];\n                const isCurrent = step === 2 && i === currentBatch;\n                return (\n                  <div key={i} style={{\n                    padding: '8px 10px',\n                    borderRadius: '6px',\n                    background: isCurrent ? color + '30' : theme.colors.surfaceAlt,\n                    border: `2px solid ${isCurrent ? color : 'transparent'}`,\n                    transition: 'all 0.3s ease',\n                  }}>\n                    <div style={{ fontSize: '12px', color: color, fontWeight: '600' }}>\n                      Batch {i}\n                    </div>\n                    <div style={{ fontSize: '11px', color: theme.colors.textSecondary }}>\n                      indices [{batch.startIdx}:{batch.endIdx}] • {batch.X.length} sample{batch.X.length > 1 ? 's' : ''}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n\n          {/* Output format */}\n          {step >= 3 && (\n            <div style={{ background: theme.colors.green + '15', borderRadius: '8px', padding: '12px',\n              border: `2px solid ${theme.colors.green}` }}>\n              <div style={{ fontSize: '12px', color: theme.colors.green, marginBottom: '8px', fontWeight: '600' }}>\n                Output Format\n              </div>\n              <div style={{ fontSize: '11px', color: theme.colors.textSecondary, lineHeight: 1.6 }}>\n                <div style={{ color: theme.colors.textMuted }}>batches = [</div>\n                {batches.map((batch, i) => (\n                  <div key={i} style={{ paddingLeft: '10px', color: batchColors[i % batchColors.length] }}>\n                    [X[{batch.startIdx}:{batch.endIdx}], y[{batch.startIdx}:{batch.endIdx}]],\n                  </div>\n                ))}\n                <div style={{ color: theme.colors.textMuted }}>]</div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Key Insight */}\n      <div style={{ background: theme.colors.surfaceAlt, borderRadius: '8px', padding: '10px 14px',\n        fontSize: '12px', color: theme.colors.textSecondary, borderLeft: `3px solid ${theme.colors.primary}` }}>\n        <span style={{ color: theme.colors.primary, fontWeight: '600' }}>Key: </span>\n        {step === 0 && 'Large datasets don\\'t fit in memory. We process them in smaller \"batches\" during training.'}\n        {step === 1 && 'batch_size controls how many samples per batch. Smaller = more batches, less memory. Last batch may be smaller!'}\n        {step === 2 && 'The iterator yields one batch at a time. Each batch has the corresponding X and y slices.'}\n        {step === 3 && 'for X_batch, y_batch in batch_iterator(X, y, batch_size=2): lets you loop through all batches during training.'}\n      </div>\n    </div>\n  );\n}",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showEditor": false,
    "editorWidthPercentage": 35,
    "showConsole": false
  },
  "dependencies": {}
}