{
  "problem_id": 12,
  "title": "Singular Value Decomposition (SVD) of 2x2 Matrix",
  "category": "Linear Algebra",
  "enabled": true,
  "type": "react",
  "code": "import React, { useState, useMemo, useRef, useEffect } from 'react';\n\n// ============================================\n// Design Tokens\n// ============================================\nconst theme = {\n  colors: {\n    primary: '#8b5cf6',\n    background: '#0a0a0a',\n    surface: '#111111',\n    surfaceAlt: '#1a1a1a',\n    border: '#2a2a2a',\n    text: '#fafafa',\n    textSecondary: '#a1a1aa',\n    textMuted: '#52525b',\n    positive: '#10b981',\n    negative: '#f43f5e',\n    blue: '#38bdf8',\n    yellow: '#fbbf24',\n    pink: '#f472b6',\n    green: '#a3e635',\n    orange: '#fb923c',\n  },\n  font: \"'JetBrains Mono', monospace\",\n};\n\n// ============================================\n// SVD Computation\n// ============================================\nfunction computeSVD(A) {\n  const AtA = [\n    [A[0][0]*A[0][0] + A[1][0]*A[1][0], A[0][0]*A[0][1] + A[1][0]*A[1][1]],\n    [A[0][0]*A[0][1] + A[1][0]*A[1][1], A[0][1]*A[0][1] + A[1][1]*A[1][1]]\n  ];\n  \n  let theta;\n  if (Math.abs(AtA[0][0] - AtA[1][1]) < 1e-10) {\n    theta = Math.PI / 4;\n  } else {\n    theta = 0.5 * Math.atan2(2 * AtA[0][1], AtA[0][0] - AtA[1][1]);\n  }\n  \n  const c = Math.cos(theta);\n  const s = Math.sin(theta);\n  \n  const V = [[c, -s], [s, c]];\n  const Vt = [[c, s], [-s, c]];\n  \n  const D00 = c*c*AtA[0][0] + 2*c*s*AtA[0][1] + s*s*AtA[1][1];\n  const D11 = s*s*AtA[0][0] - 2*c*s*AtA[0][1] + c*c*AtA[1][1];\n  \n  const s1 = Math.sqrt(Math.max(0, D00));\n  const s2 = Math.sqrt(Math.max(0, D11));\n  const S = [s1, s2];\n  \n  const AV = [\n    [A[0][0]*V[0][0] + A[0][1]*V[1][0], A[0][0]*V[0][1] + A[0][1]*V[1][1]],\n    [A[1][0]*V[0][0] + A[1][1]*V[1][0], A[1][0]*V[0][1] + A[1][1]*V[1][1]]\n  ];\n  \n  const U = [\n    [s1 > 1e-10 ? AV[0][0]/s1 : 0, s2 > 1e-10 ? AV[0][1]/s2 : 0],\n    [s1 > 1e-10 ? AV[1][0]/s1 : 0, s2 > 1e-10 ? AV[1][1]/s2 : 0]\n  ];\n  \n  return { U, S, V, Vt, theta };\n}\n\n// ============================================\n// Transform Visualization\n// ============================================\nfunction TransformViz({ A, step }) {\n  const canvasRef = useRef(null);\n  const size = 260;\n  const center = size / 2;\n  const scale = 32;\n  \n  const { U, S, V, Vt } = useMemo(() => computeSVD(A), [A]);\n  \n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    \n    ctx.fillStyle = theme.colors.surface;\n    ctx.fillRect(0, 0, size, size);\n    \n    // Draw grid\n    ctx.strokeStyle = theme.colors.border;\n    ctx.lineWidth = 1;\n    for (let i = -4; i <= 4; i++) {\n      ctx.beginPath();\n      ctx.moveTo(center + i * scale, 0);\n      ctx.lineTo(center + i * scale, size);\n      ctx.stroke();\n      ctx.beginPath();\n      ctx.moveTo(0, center + i * scale);\n      ctx.lineTo(size, center + i * scale);\n      ctx.stroke();\n    }\n    \n    // Draw axes\n    ctx.strokeStyle = theme.colors.textMuted;\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo(0, center);\n    ctx.lineTo(size, center);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(center, 0);\n    ctx.lineTo(center, size);\n    ctx.stroke();\n    \n    // Helper: transform point based on step\n    const transformPoint = (x, y) => {\n      let px = x, py = y;\n      \n      if (step >= 1) {\n        const nx = Vt[0][0] * px + Vt[0][1] * py;\n        const ny = Vt[1][0] * px + Vt[1][1] * py;\n        px = nx; py = ny;\n      }\n      if (step >= 2) {\n        px = S[0] * px;\n        py = S[1] * py;\n      }\n      if (step >= 3) {\n        const nx = U[0][0] * px + U[0][1] * py;\n        const ny = U[1][0] * px + U[1][1] * py;\n        px = nx; py = ny;\n      }\n      \n      return [center + px * scale, center - py * scale];\n    };\n    \n    // Draw unit circle / transformed shape\n    ctx.beginPath();\n    for (let t = 0; t <= 2 * Math.PI; t += 0.05) {\n      const x = Math.cos(t);\n      const y = Math.sin(t);\n      const [px, py] = transformPoint(x, y);\n      if (t === 0) ctx.moveTo(px, py);\n      else ctx.lineTo(px, py);\n    }\n    ctx.closePath();\n    \n    const colors = [theme.colors.textMuted, theme.colors.pink, theme.colors.yellow, theme.colors.green];\n    ctx.strokeStyle = colors[step];\n    ctx.lineWidth = 3;\n    ctx.stroke();\n    ctx.fillStyle = `${colors[step]}20`;\n    ctx.fill();\n    \n    // Draw basis vectors\n    const drawVector = (x, y, color) => {\n      const [ex, ey] = transformPoint(x, y);\n      ctx.strokeStyle = color;\n      ctx.lineWidth = 3;\n      ctx.beginPath();\n      ctx.moveTo(center, center);\n      ctx.lineTo(ex, ey);\n      ctx.stroke();\n      \n      const angle = Math.atan2(center - ey, ex - center);\n      ctx.beginPath();\n      ctx.moveTo(ex, ey);\n      ctx.lineTo(ex - 10 * Math.cos(angle - 0.4), ey + 10 * Math.sin(angle - 0.4));\n      ctx.lineTo(ex - 10 * Math.cos(angle + 0.4), ey + 10 * Math.sin(angle + 0.4));\n      ctx.closePath();\n      ctx.fillStyle = color;\n      ctx.fill();\n    };\n    \n    drawVector(1, 0, theme.colors.pink);\n    drawVector(0, 1, theme.colors.blue);\n    \n    // Step label\n    const labels = ['Unit Circle', 'After V^T', 'After Sigma', 'After U = A'];\n    ctx.fillStyle = theme.colors.text;\n    ctx.font = '11px JetBrains Mono';\n    ctx.textAlign = 'center';\n    ctx.fillText(labels[step], center, size - 8);\n    \n  }, [A, step, U, S, Vt]);\n  \n  return (\n    <canvas\n      ref={canvasRef}\n      width={size}\n      height={size}\n      style={{ borderRadius: '10px', display: 'block' }}\n    />\n  );\n}\n\n// ============================================\n// Matrix Display\n// ============================================\nfunction MatrixDisplay({ matrix, label, color, highlight }) {\n  return (\n    <div style={{ textAlign: 'center' }}>\n      {label && (\n        <div style={{ fontSize: '9px', color: theme.colors.textMuted, marginBottom: '2px' }}>\n          {label}\n        </div>\n      )}\n      <div style={{\n        display: 'inline-flex',\n        alignItems: 'center',\n        gap: '2px',\n        padding: '4px 6px',\n        background: highlight ? `${color}15` : 'transparent',\n        borderRadius: '6px',\n        border: `1px solid ${highlight ? color : theme.colors.border}40`,\n      }}>\n        <span style={{ color: highlight ? color : theme.colors.textMuted, fontSize: '16px', fontWeight: '200' }}>[</span>\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n          {matrix.map((row, i) => (\n            <div key={i} style={{ display: 'flex', gap: '4px' }}>\n              {row.map((val, j) => (\n                <div key={j} style={{\n                  width: '32px',\n                  height: '20px',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  fontSize: '10px',\n                  fontWeight: '600',\n                  color: theme.colors.text,\n                }}>\n                  {typeof val === 'number' ? val.toFixed(2) : val}\n                </div>\n              ))}\n            </div>\n          ))}\n        </div>\n        <span style={{ color: highlight ? color : theme.colors.textMuted, fontSize: '16px', fontWeight: '200' }}>]</span>\n      </div>\n    </div>\n  );\n}\n\n// ============================================\n// Main App\n// ============================================\nexport default function SVDPlayground() {\n  const [exampleIdx, setExampleIdx] = useState(0);\n  const [step, setStep] = useState(0);\n  const [playing, setPlaying] = useState(false);\n  \n  const examples = [\n    { name: 'Symmetric', A: [[2, 1], [1, 2]] },\n    { name: 'Shear', A: [[1, 1], [0, 1]] },\n    { name: 'Scale', A: [[3, 0], [0, 1]] },\n    { name: 'General', A: [[1, 2], [3, 4]] },\n  ];\n  \n  const A = examples[exampleIdx].A;\n  const { U, S, V, Vt } = useMemo(() => computeSVD(A), [A]);\n  \n  const reset = () => { setStep(0); setPlaying(false); };\n  const next = () => step < 3 && setStep(step + 1);\n  const prev = () => step > 0 && setStep(step - 1);\n  \n  const auto = async () => {\n    setPlaying(true);\n    for (let s = 0; s <= 3; s++) {\n      setStep(s);\n      await new Promise(r => setTimeout(r, 1200));\n    }\n    setPlaying(false);\n  };\n\n  const stepInfo = [\n    { title: \"Start: Unit Circle\", desc: \"We begin with a circle of radius 1. Every point is distance 1 from the origin.\", color: theme.colors.textMuted },\n    { title: \"Step 1: First Rotation (V^T)\", desc: \"Rotate to align with the natural directions of the transformation. Think of finding the best angle to view the stretch.\", color: theme.colors.pink },\n    { title: \"Step 2: Stretch (Sigma)\", desc: `Stretch horizontally by ${S[0].toFixed(2)}x, vertically by ${S[1].toFixed(2)}x. The circle becomes an ellipse. These are the singular values.`, color: theme.colors.yellow },\n    { title: \"Step 3: Second Rotation (U)\", desc: \"Final rotation to match the output orientation. Now we have reconstructed exactly what matrix A does.\", color: theme.colors.green },\n  ];\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: theme.colors.background,\n      color: theme.colors.text,\n      fontFamily: theme.font,\n      padding: '16px',\n    }}>\n      <div style={{ maxWidth: '480px', margin: '0 auto' }}>\n        {/* Header */}\n        <div style={{ textAlign: 'center', marginBottom: '16px' }}>\n          <h1 style={{ fontSize: '18px', fontWeight: '700', margin: 0 }}>SVD Decomposition</h1>\n          <p style={{ color: theme.colors.textSecondary, fontSize: '11px', marginTop: '4px' }}>\n            Any matrix = Rotate, Stretch, Rotate\n          </p>\n        </div>\n        \n        {/* Example Tabs */}\n        <div style={{ display: 'flex', gap: '6px', justifyContent: 'center', marginBottom: '16px' }}>\n          {examples.map((e, idx) => (\n            <button\n              key={idx}\n              onClick={() => { setExampleIdx(idx); reset(); }}\n              style={{\n                padding: '6px 12px',\n                background: exampleIdx === idx ? theme.colors.primary : theme.colors.surface,\n                border: 'none',\n                borderRadius: '6px',\n                color: exampleIdx === idx ? '#fff' : theme.colors.textSecondary,\n                fontFamily: theme.font,\n                fontSize: '11px',\n                cursor: 'pointer',\n              }}\n            >\n              {e.name}\n            </button>\n          ))}\n        </div>\n        \n        {/* Main Card */}\n        <div style={{ background: theme.colors.surfaceAlt, borderRadius: '12px', padding: '16px' }}>\n          \n          {/* Visualization */}\n          <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '12px' }}>\n            <TransformViz A={A} step={step} />\n          </div>\n          \n          {/* Step Explanation - ALWAYS RIGHT AFTER GRAPH */}\n          <div style={{\n            padding: '12px',\n            background: theme.colors.surface,\n            borderRadius: '8px',\n            borderLeft: `3px solid ${stepInfo[step].color}`,\n            marginBottom: '12px',\n          }}>\n            <div style={{ fontSize: '12px', fontWeight: '600', color: theme.colors.text, marginBottom: '4px' }}>\n              {stepInfo[step].title}\n            </div>\n            <div style={{ fontSize: '11px', color: theme.colors.textSecondary, lineHeight: 1.5 }}>\n              {stepInfo[step].desc}\n            </div>\n          </div>\n          \n          {/* SVD Decomposition - Always visible */}\n          <div style={{ marginBottom: '12px' }}>\n            <div style={{ fontSize: '9px', color: theme.colors.textMuted, marginBottom: '6px', textAlign: 'center' }}>\n              A = U x Sigma x V^T\n            </div>\n            <div style={{ display: 'flex', gap: '4px', justifyContent: 'center', alignItems: 'center', flexWrap: 'wrap' }}>\n              <MatrixDisplay matrix={A} label=\"A\" color={theme.colors.text} highlight={false} />\n              <span style={{ color: theme.colors.textMuted, fontSize: '12px' }}>=</span>\n              <MatrixDisplay matrix={U} label=\"U\" color={theme.colors.green} highlight={step >= 3} />\n              <span style={{ color: theme.colors.textMuted, fontSize: '10px' }}>x</span>\n              <MatrixDisplay \n                matrix={[[S[0].toFixed(1), '0'], ['0', S[1].toFixed(1)]]} \n                label=\"Sigma\" \n                color={theme.colors.yellow} \n                highlight={step >= 2} \n              />\n              <span style={{ color: theme.colors.textMuted, fontSize: '10px' }}>x</span>\n              <MatrixDisplay matrix={Vt} label=\"V^T\" color={theme.colors.pink} highlight={step >= 1} />\n            </div>\n          </div>\n          \n          {/* Singular Values */}\n          <div style={{\n            padding: '10px',\n            background: theme.colors.surface,\n            borderRadius: '8px',\n            marginBottom: '12px',\n          }}>\n            <div style={{ fontSize: '9px', color: theme.colors.textMuted, marginBottom: '6px', textAlign: 'center' }}>\n              SINGULAR VALUES (stretch factors)\n            </div>\n            <div style={{ display: 'flex', gap: '24px', justifyContent: 'center' }}>\n              <div style={{ textAlign: 'center' }}>\n                <span style={{ fontSize: '18px', fontWeight: '700', color: step >= 2 ? theme.colors.yellow : theme.colors.textMuted }}>\n                  {S[0].toFixed(2)}\n                </span>\n                <div style={{ fontSize: '9px', color: theme.colors.textMuted }}>sigma 1</div>\n              </div>\n              <div style={{ textAlign: 'center' }}>\n                <span style={{ fontSize: '18px', fontWeight: '700', color: step >= 2 ? theme.colors.yellow : theme.colors.textMuted }}>\n                  {S[1].toFixed(2)}\n                </span>\n                <div style={{ fontSize: '9px', color: theme.colors.textMuted }}>sigma 2</div>\n              </div>\n            </div>\n          </div>\n          \n          {/* Step Indicator */}\n          <div style={{ display: 'flex', gap: '4px', justifyContent: 'center', marginBottom: '12px' }}>\n            {[0, 1, 2, 3].map(i => (\n              <div\n                key={i}\n                onClick={() => setStep(i)}\n                style={{\n                  width: i === step ? '20px' : '8px',\n                  height: '8px',\n                  borderRadius: '4px',\n                  background: i <= step ? theme.colors.primary : theme.colors.border,\n                  cursor: 'pointer',\n                  transition: 'all 0.3s',\n                }}\n              />\n            ))}\n          </div>\n          \n          {/* Controls */}\n          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\n            <button onClick={prev} disabled={step <= 0} style={{\n              padding: '10px 14px',\n              background: theme.colors.surface,\n              border: 'none',\n              borderRadius: '8px',\n              color: step <= 0 ? theme.colors.textMuted : theme.colors.text,\n              cursor: step <= 0 ? 'not-allowed' : 'pointer',\n              fontSize: '14px',\n            }}>\n              ←\n            </button>\n            \n            <button onClick={next} disabled={step >= 3} style={{\n              flex: 1,\n              padding: '12px',\n              background: step < 3 ? theme.colors.primary : theme.colors.positive,\n              border: 'none',\n              borderRadius: '8px',\n              color: '#fff',\n              fontFamily: theme.font,\n              fontSize: '12px',\n              fontWeight: '600',\n              cursor: step < 3 ? 'pointer' : 'default',\n            }}>\n              {step === 0 ? 'Start' : step < 3 ? 'Next Step' : 'Complete'}\n            </button>\n            \n            <button onClick={auto} disabled={playing || step >= 3} style={{\n              padding: '10px 14px',\n              background: theme.colors.surface,\n              border: 'none',\n              borderRadius: '8px',\n              color: playing || step >= 3 ? theme.colors.textMuted : theme.colors.text,\n              cursor: playing || step >= 3 ? 'not-allowed' : 'pointer',\n              fontSize: '12px',\n            }}>\n              ▶▶\n            </button>\n            \n            <button onClick={reset} style={{\n              padding: '10px 14px',\n              background: theme.colors.surface,\n              border: 'none',\n              borderRadius: '8px',\n              color: theme.colors.text,\n              cursor: 'pointer',\n              fontSize: '14px',\n            }}>\n              ↺\n            </button>\n          </div>\n        </div>\n        \n        {/* Key Insight */}\n        <div style={{\n          marginTop: '12px',\n          padding: '10px 14px',\n          background: theme.colors.surface,\n          borderRadius: '8px',\n          fontSize: '10px',\n          color: theme.colors.textSecondary,\n          textAlign: 'center',\n        }}>\n          <strong style={{ color: theme.colors.text }}>Why it matters:</strong> SVD reveals how much a transformation stretches in each direction. Used in image compression, recommendations, and data analysis.\n        </div>\n      </div>\n    </div>\n  );\n}",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showEditor": false,
    "editorWidthPercentage": 35,
    "showConsole": false
  },
  "dependencies": {}
}