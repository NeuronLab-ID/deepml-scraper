{
  "problem_id": 39,
  "title": "Implementation of Log Softmax Function",
  "category": "Deep Learning",
  "enabled": true,
  "type": "react",
  "code": "import React, { useState } from 'react';\n\nconst theme = {\n  colors: {\n    primary: '#8b5cf6',\n    background: '#0a0a0a',\n    surface: '#111111',\n    surfaceAlt: '#1a1a1a',\n    border: '#2a2a2a',\n    text: '#fafafa',\n    textSecondary: '#a1a1aa',\n    textMuted: '#52525b',\n    blue: '#38bdf8',\n    yellow: '#fbbf24',\n    pink: '#f472b6',\n    green: '#a3e635',\n    orange: '#fb923c',\n    red: '#f87171',\n  },\n  font: \"'JetBrains Mono', monospace\",\n};\n\nconst COLORS = ['#38bdf8', '#f472b6', '#a3e635'];\nconst NAMES = ['A', 'B', 'C'];\n\nexport default function App() {\n  const [scores, setScores] = useState([1, 2, 3]);\n  const [dragging, setDragging] = useState(null);\n\n  // Calculations\n  const maxScore = Math.max(...scores);\n  const shifted = scores.map(s => s - maxScore);\n  const exps = shifted.map(s => Math.exp(s));\n  const sumExp = exps.reduce((a, b) => a + b, 0);\n  const logSumExp = Math.log(sumExp);\n  const logSoftmax = shifted.map(s => s - logSumExp);\n  const probs = logSoftmax.map(ls => Math.exp(ls));\n\n  const barHeight = 180;\n  const barWidth = 60;\n\n  const handleMouseMove = (e, containerRef) => {\n    if (dragging === null) return;\n    const rect = e.currentTarget.getBoundingClientRect();\n    const y = e.clientY - rect.top;\n    const score = Math.round((1 - y / barHeight) * 10 - 2);\n    const clamped = Math.max(-2, Math.min(8, score));\n    const newScores = [...scores];\n    newScores[dragging] = clamped;\n    setScores(newScores);\n  };\n\n  return (\n    <div style={{ background: theme.colors.background, minHeight: '100vh', padding: '16px', fontFamily: theme.font, color: theme.colors.text }}>\n      \n      {/* Header */}\n      <div style={{ marginBottom: '16px' }}>\n        <div style={{ fontSize: '18px', fontWeight: '700' }}>Log Softmax</div>\n        <div style={{ fontSize: '12px', color: theme.colors.textSecondary }}>Drag the bars! Higher score â†’ bigger share of probability</div>\n      </div>\n\n      <div style={{ display: 'flex', gap: '24px' }}>\n        \n        {/* Left: Draggable score bars */}\n        <div style={{ background: theme.colors.surface, borderRadius: '12px', padding: '20px' }}>\n          <div style={{ fontSize: '12px', color: theme.colors.textMuted, marginBottom: '12px', textAlign: 'center' }}>\n            Scores (drag up/down)\n          </div>\n          \n          <div style={{ display: 'flex', gap: '16px', alignItems: 'flex-end' }}\n            onMouseMove={handleMouseMove}\n            onMouseUp={() => setDragging(null)}\n            onMouseLeave={() => setDragging(null)}>\n            \n            {scores.map((score, i) => {\n              const fillHeight = ((score + 2) / 10) * barHeight;\n              return (\n                <div key={i} style={{ textAlign: 'center' }}>\n                  {/* Score value */}\n                  <div style={{ fontSize: '20px', fontWeight: '700', color: COLORS[i], marginBottom: '8px' }}>\n                    {score}\n                  </div>\n                  \n                  {/* Bar container */}\n                  <div style={{\n                    width: barWidth, height: barHeight, borderRadius: '8px',\n                    background: theme.colors.surfaceAlt, position: 'relative',\n                    border: `2px solid ${theme.colors.border}`, cursor: 'ns-resize',\n                    overflow: 'hidden',\n                  }}\n                    onMouseDown={() => setDragging(i)}>\n                    \n                    {/* Filled portion */}\n                    <div style={{\n                      position: 'absolute', bottom: 0, left: 0, right: 0,\n                      height: fillHeight, background: COLORS[i],\n                      opacity: 0.7, transition: 'height 0.1s ease',\n                    }} />\n                    \n                    {/* Drag handle */}\n                    <div style={{\n                      position: 'absolute', bottom: fillHeight - 4, left: 0, right: 0,\n                      height: '8px', background: COLORS[i], borderRadius: '4px',\n                      cursor: 'ns-resize',\n                    }} />\n                  </div>\n                  \n                  {/* Label */}\n                  <div style={{ fontSize: '14px', fontWeight: '600', color: COLORS[i], marginTop: '8px' }}>\n                    {NAMES[i]}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n\n          {/* Scale markers */}\n          <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '8px', fontSize: '10px', color: theme.colors.textMuted }}>\n            <span>-2</span>\n            <span>8</span>\n          </div>\n        </div>\n\n        {/* Middle: Probability visualization */}\n        <div style={{ background: theme.colors.surface, borderRadius: '12px', padding: '20px', flex: 1 }}>\n          <div style={{ fontSize: '12px', color: theme.colors.textMuted, marginBottom: '12px', textAlign: 'center' }}>\n            Probability Share\n          </div>\n          \n          {/* Stacked bar showing probability distribution */}\n          <div style={{ display: 'flex', height: '50px', borderRadius: '8px', overflow: 'hidden', marginBottom: '16px' }}>\n            {probs.map((p, i) => (\n              <div key={i} style={{\n                width: `${p * 100}%`, height: '100%',\n                background: COLORS[i], \n                display: 'flex', alignItems: 'center', justifyContent: 'center',\n                fontSize: '14px', fontWeight: '700', color: theme.colors.background,\n                transition: 'width 0.15s ease',\n                minWidth: p > 0.05 ? '40px' : '0',\n              }}>\n                {p > 0.05 ? `${(p * 100).toFixed(0)}%` : ''}\n              </div>\n            ))}\n          </div>\n\n          {/* Individual probability cards */}\n          <div style={{ display: 'flex', gap: '12px' }}>\n            {probs.map((p, i) => (\n              <div key={i} style={{\n                flex: 1, padding: '12px', borderRadius: '8px',\n                background: COLORS[i] + '20', border: `2px solid ${COLORS[i]}`,\n                textAlign: 'center',\n              }}>\n                <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginBottom: '4px' }}>{NAMES[i]}</div>\n                <div style={{ fontSize: '24px', fontWeight: '700', color: COLORS[i] }}>\n                  {(p * 100).toFixed(1)}%\n                </div>\n                <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginTop: '4px' }}>\n                  log: {logSoftmax[i].toFixed(3)}\n                </div>\n              </div>\n            ))}\n          </div>\n\n          {/* Sum check */}\n          <div style={{ marginTop: '12px', textAlign: 'center', fontSize: '11px', color: theme.colors.textMuted }}>\n            Sum: {probs.reduce((a, b) => a + b, 0).toFixed(3)} (always = 1.0)\n          </div>\n        </div>\n\n        {/* Right: The math */}\n        <div style={{ background: theme.colors.surface, borderRadius: '12px', padding: '20px', width: '180px' }}>\n          <div style={{ fontSize: '12px', color: theme.colors.textMuted, marginBottom: '12px' }}>\n            How it works\n          </div>\n          \n          <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', fontSize: '12px' }}>\n            <div style={{ padding: '8px', background: theme.colors.surfaceAlt, borderRadius: '6px' }}>\n              <div style={{ color: theme.colors.textMuted, marginBottom: '4px' }}>1. Subtract max</div>\n              <div style={{ color: theme.colors.blue, fontFamily: 'monospace' }}>\n                [{shifted.map(s => s.toFixed(1)).join(', ')}]\n              </div>\n            </div>\n            \n            <div style={{ padding: '8px', background: theme.colors.surfaceAlt, borderRadius: '6px' }}>\n              <div style={{ color: theme.colors.textMuted, marginBottom: '4px' }}>2. exp() each</div>\n              <div style={{ color: theme.colors.yellow, fontFamily: 'monospace' }}>\n                [{exps.map(e => e.toFixed(2)).join(', ')}]\n              </div>\n            </div>\n            \n            <div style={{ padding: '8px', background: theme.colors.surfaceAlt, borderRadius: '6px' }}>\n              <div style={{ color: theme.colors.textMuted, marginBottom: '4px' }}>3. log(sum) =</div>\n              <div style={{ color: theme.colors.pink, fontFamily: 'monospace', fontSize: '14px', fontWeight: '600' }}>\n                {logSumExp.toFixed(3)}\n              </div>\n            </div>\n            \n            <div style={{ padding: '8px', background: theme.colors.green + '20', borderRadius: '6px', border: `1px solid ${theme.colors.green}` }}>\n              <div style={{ color: theme.colors.green, marginBottom: '4px' }}>4. Log Softmax</div>\n              <div style={{ color: theme.colors.green, fontFamily: 'monospace', fontWeight: '600' }}>\n                [{logSoftmax.map(l => l.toFixed(2)).join(', ')}]\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Insight */}\n      <div style={{ background: theme.colors.surfaceAlt, borderRadius: '8px', padding: '12px', marginTop: '16px',\n        fontSize: '12px', color: theme.colors.textSecondary, borderLeft: `4px solid ${theme.colors.primary}` }}>\n        <span style={{ color: theme.colors.primary, fontWeight: '600' }}>ðŸ’¡ Try: </span>\n        Make one score much higher than others â€” watch it steal almost all the probability! \n        Or make them equal â€” they split evenly. Log values are always â‰¤ 0 (since probabilities are â‰¤ 1).\n      </div>\n    </div>\n  );\n}",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showEditor": false,
    "editorWidthPercentage": 35,
    "showConsole": false
  },
  "dependencies": {}
}