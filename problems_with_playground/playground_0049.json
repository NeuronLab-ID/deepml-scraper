{
  "problem_id": 49,
  "title": "Implement Adam Optimization Algorithm",
  "category": "Deep Learning",
  "enabled": true,
  "type": "react",
  "code": "import React, { useState, useEffect, useRef } from 'react';\n\nconst theme = {\n  bg: { primary: '#0a0a0f', card: '#141420', hover: '#1e1e2e' },\n  accent: { blue: '#4facfe', cyan: '#00f2fe', gold: '#f6b93b', pink: '#ee5a6f', green: '#26de81', purple: '#a55eea' },\n  text: { primary: '#fff', secondary: '#8b8b9e', muted: '#5a5a6e' },\n  border: '#2a2a3a',\n};\n\nconst loss = (x) => x * x * x * x - 3 * x * x + x + 2;\nconst grad = (x) => 4 * x * x * x - 6 * x + 1;\n\nexport default function App() {\n  const [running, setRunning] = useState(false);\n  const [step, setStep] = useState(0);\n  const [lr, setLr] = useState(0.15);\n  const [beta1, setBeta1] = useState(0.9);\n  const [beta2, setBeta2] = useState(0.999);\n  \n  const [startX, setStartX] = useState(1.5);\n  const [adamX, setAdamX] = useState(startX);\n  const [sgdX, setSgdX] = useState(startX);\n  const [m, setM] = useState(0);\n  const [v, setV] = useState(0);\n  const [adamHist, setAdamHist] = useState([{ x: startX, y: loss(startX) }]);\n  const [sgdHist, setSgdHist] = useState([{ x: startX, y: loss(startX) }]);\n  const [gradHist, setGradHist] = useState([]);\n  const [adaptiveLrHist, setAdaptiveLrHist] = useState([]);\n  const [dragging, setDragging] = useState(false);\n  \n  const svgRef = useRef(null);\n\n  const reset = (newStartX = startX) => {\n    setRunning(false); setStep(0);\n    setAdamX(newStartX); setSgdX(newStartX); setM(0); setV(0);\n    setAdamHist([{ x: newStartX, y: loss(newStartX) }]);\n    setSgdHist([{ x: newStartX, y: loss(newStartX) }]);\n    setGradHist([]); setAdaptiveLrHist([]);\n  };\n\n  const runStep = () => {\n    const t = step + 1;\n    setStep(t);\n    const gSgd = grad(sgdX);\n    const newSgdX = sgdX - 0.02 * gSgd;\n    setSgdX(newSgdX);\n    setSgdHist(h => [...h, { x: newSgdX, y: loss(newSgdX) }]);\n    \n    const g = grad(adamX);\n    const newM = beta1 * m + (1 - beta1) * g;\n    const newV = beta2 * v + (1 - beta2) * g * g;\n    const mHat = newM / (1 - Math.pow(beta1, t));\n    const vHat = newV / (1 - Math.pow(beta2, t));\n    const adaptiveLr = lr / (Math.sqrt(vHat) + 1e-8);\n    const newX = adamX - lr * mHat / (Math.sqrt(vHat) + 1e-8);\n    \n    setM(newM); setV(newV); setAdamX(newX);\n    setAdamHist(h => [...h, { x: newX, y: loss(newX) }]);\n    setGradHist(h => [...h.slice(-7), Math.abs(g)]);\n    setAdaptiveLrHist(h => [...h.slice(-7), adaptiveLr]);\n  };\n\n  useEffect(() => {\n    if (!running || step >= 60) { setRunning(false); return; }\n    const timer = setTimeout(runStep, 150);\n    return () => clearTimeout(timer);\n  }, [running, step]);\n\n  const plotW = 340, plotH = 220;\n  const yMin = -2, yMax = 5;\n  const padTop = 20, padBot = 25;\n  const toX = (x) => ((x + 2) / 4) * plotW;\n  const toY = (y) => padTop + (plotH - padTop - padBot) * (1 - (y - yMin) / (yMax - yMin));\n  const fromX = (px) => (px / plotW) * 4 - 2;\n  \n  const curve = [];\n  for (let x = -2; x <= 2; x += 0.04) curve.push({ x, y: loss(x) });\n\n  const mHat = step > 0 ? m / (1 - Math.pow(beta1, step)) : 0;\n  const vHat = step > 0 ? v / (1 - Math.pow(beta2, step)) : 0.001;\n  const adaptiveLr = lr / (Math.sqrt(vHat) + 1e-8);\n\n  const handleMouseDown = () => { if (step === 0) setDragging(true); };\n  const handleMouseMove = (e) => {\n    if (!dragging || !svgRef.current) return;\n    const rect = svgRef.current.getBoundingClientRect();\n    const px = e.clientX - rect.left;\n    const newX = Math.max(-1.9, Math.min(1.9, fromX(px)));\n    setStartX(newX);\n    reset(newX);\n  };\n  const handleMouseUp = () => setDragging(false);\n\n  const minX = -1.3;\n  const minY = loss(minX);\n\n  // Dynamic insight based on step\n  const getInsight = () => {\n    if (step === 0) return \"Drag the gold ball to set starting position, then click Run or Step to begin optimization.\";\n    if (step < 5) return \"Early steps: Momentum (m) is building up from gradients. Bias correction is important here since m starts at 0.\";\n    if (step < 15) return \"Adam adapts its learning rate based on gradient history. Large gradients ‚Üí smaller steps, preventing overshooting.\";\n    if (step < 30) return \"Notice how Adam (gold) takes a smoother path than SGD (pink). Momentum helps it maintain direction.\";\n    if (adaptiveLr < 0.05) return \"Learning rate has shrunk significantly. Near the minimum, Adam takes smaller, careful steps.\";\n    return \"Adam combines the best of momentum (direction smoothing) and RMSprop (adaptive step size) for stable convergence.\";\n  };\n\n  return (\n    <div style={{ padding: '16px', fontFamily: '-apple-system, sans-serif', background: theme.bg.primary, color: theme.text.primary, minHeight: '100vh', boxSizing: 'border-box' }}\n      onMouseUp={handleMouseUp} onMouseLeave={handleMouseUp}>\n      \n      {/* Header */}\n      <div style={{ textAlign: 'center', marginBottom: '16px' }}>\n        <h1 style={{ fontSize: '24px', fontWeight: '700', margin: 0, background: 'linear-gradient(135deg, #4facfe, #00f2fe)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent' }}>Adam Optimizer</h1>\n        <p style={{ color: theme.text.secondary, fontSize: '12px', margin: '4px 0 0' }}>Momentum + Adaptive Learning Rate</p>\n      </div>\n\n      {/* Main row: Graph left, Cards right */}\n      <div style={{ display: 'flex', gap: '16px', marginBottom: '16px' }}>\n        \n        {/* Loss Curve */}\n        <div style={{ background: theme.bg.card, borderRadius: '12px', padding: '14px' }}>\n          <svg ref={svgRef} width={plotW} height={plotH} onMouseMove={handleMouseMove} style={{ cursor: step === 0 ? 'crosshair' : 'default' }}>\n            <defs><linearGradient id=\"curveG\" x1=\"0%\" y1=\"0%\" x2=\"100%\"><stop offset=\"0%\" stopColor={theme.accent.purple} stopOpacity=\"0.5\"/><stop offset=\"100%\" stopColor={theme.accent.cyan} stopOpacity=\"0.5\"/></linearGradient></defs>\n            \n            <path d={curve.map((p,i) => `${i===0?'M':'L'} ${toX(p.x)} ${toY(p.y)}`).join(' ')} fill=\"none\" stroke=\"url(#curveG)\" strokeWidth=\"3\"/>\n            \n            {sgdHist.length > 1 && <path d={sgdHist.map((p,i) => `${i===0?'M':'L'} ${toX(p.x)} ${toY(p.y)}`).join(' ')} fill=\"none\" stroke={theme.accent.pink} strokeWidth=\"2\" strokeDasharray=\"5,3\" opacity=\"0.7\"/>}\n            \n            {adamHist.length > 1 && <path d={adamHist.map((p,i) => `${i===0?'M':'L'} ${toX(p.x)} ${toY(p.y)}`).join(' ')} fill=\"none\" stroke={theme.accent.gold} strokeWidth=\"3\"/>}\n            \n            <circle cx={toX(sgdX)} cy={toY(loss(sgdX))} r=\"6\" fill={theme.accent.pink}/>\n            <circle cx={toX(adamX)} cy={toY(loss(adamX))} r=\"9\" fill={theme.accent.gold} stroke=\"#fff\" strokeWidth=\"2\" style={{ cursor: step === 0 ? 'grab' : 'default' }} onMouseDown={handleMouseDown}/>\n            \n            <circle cx={toX(minX)} cy={toY(minY)} r=\"6\" fill={theme.accent.green} stroke=\"#fff\" strokeWidth=\"1\"/>\n            <text x={toX(minX) + 12} y={toY(minY) + 4} fontSize=\"11\" fill={theme.accent.green}>min</text>\n            \n            {step === 0 && <text x={toX(startX)} y={toY(loss(startX)) - 16} fontSize=\"10\" fill={theme.text.muted} textAnchor=\"middle\">drag to move</text>}\n          </svg>\n          \n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginTop: '10px', fontSize: '12px' }}>\n            <span><span style={{ color: theme.accent.gold }}>‚óè</span> Adam: {loss(adamX).toFixed(2)}</span>\n            <span><span style={{ color: theme.accent.pink }}>‚óè</span> SGD: {loss(sgdX).toFixed(2)}</span>\n            <span style={{ color: theme.text.muted }}>Step {step}</span>\n          </div>\n          \n          <div style={{ display: 'flex', gap: '8px', marginTop: '12px' }}>\n            <button onClick={() => setRunning(!running)} style={{ flex: 1, padding: '10px', border: 'none', borderRadius: '8px', cursor: 'pointer', fontWeight: '600', fontSize: '13px', background: running ? theme.accent.pink : theme.accent.green, color: '#000' }}>\n              {running ? '‚è∏ Pause' : '‚ñ∂ Run'}\n            </button>\n            <button onClick={runStep} disabled={running} style={{ padding: '10px 14px', border: 'none', borderRadius: '8px', cursor: 'pointer', fontWeight: '600', fontSize: '13px', background: theme.accent.blue, color: '#000', opacity: running ? 0.5 : 1 }}>Step</button>\n            <button onClick={() => reset(startX)} style={{ padding: '10px 14px', border: 'none', borderRadius: '8px', cursor: 'pointer', fontSize: '13px', background: theme.bg.hover, color: theme.text.secondary, border: `1px solid ${theme.border}` }}>Reset</button>\n          </div>\n        </div>\n\n        {/* Right column: Momentum & Adaptive LR stacked */}\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px', flex: 1 }}>\n          \n          {/* Momentum */}\n          <div style={{ background: theme.bg.card, borderRadius: '12px', padding: '14px', flex: 1 }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '10px' }}>\n              <div style={{ width: '32px', height: '32px', borderRadius: '8px', background: 'linear-gradient(135deg, #4facfe, #00f2fe)', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '16px' }}>üé±</div>\n              <div style={{ flex: 1 }}>\n                <div style={{ fontWeight: '600', fontSize: '14px' }}>Momentum</div>\n                <div style={{ fontSize: '10px', color: theme.text.secondary }}>Where to go (averaged gradient)</div>\n              </div>\n              <div style={{ background: theme.accent.blue, padding: '6px 12px', borderRadius: '8px', fontSize: '18px', fontWeight: '700', fontFamily: 'monospace' }}>{mHat.toFixed(2)}</div>\n            </div>\n            \n            <div style={{ display: 'flex', alignItems: 'flex-end', gap: '4px', background: theme.bg.primary, borderRadius: '8px', padding: '8px', height: '50px' }}>\n              {[...Array(8)].map((_, i) => {\n                const g = gradHist[i] || 0;\n                const maxG = Math.max(...gradHist, 0.5);\n                return <div key={i} style={{ flex: 1, height: `${(g / maxG) * 34}px`, background: theme.accent.blue, borderRadius: '3px', opacity: 0.3 + (i/8)*0.7 }}/>;\n              })}\n            </div>\n          </div>\n\n          {/* Adaptive LR */}\n          <div style={{ background: theme.bg.card, borderRadius: '12px', padding: '14px', flex: 1 }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '10px' }}>\n              <div style={{ width: '32px', height: '32px', borderRadius: '8px', background: 'linear-gradient(135deg, #f6b93b, #fa983a)', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '16px' }}>‚ö°</div>\n              <div style={{ flex: 1 }}>\n                <div style={{ fontWeight: '600', fontSize: '14px' }}>Adaptive LR</div>\n                <div style={{ fontSize: '10px', color: theme.text.secondary }}>Step size (Œ∑ / ‚àövÃÇ)</div>\n              </div>\n              <div style={{ background: theme.accent.gold, padding: '6px 12px', borderRadius: '8px', fontSize: '18px', fontWeight: '700', fontFamily: 'monospace', color: '#000' }}>{adaptiveLr.toFixed(2)}</div>\n            </div>\n            \n            <div style={{ display: 'flex', alignItems: 'flex-end', gap: '4px', background: theme.bg.primary, borderRadius: '8px', padding: '8px', height: '50px' }}>\n              {[...Array(8)].map((_, i) => {\n                const alr = adaptiveLrHist[i] || lr;\n                const maxAlr = Math.max(...adaptiveLrHist, lr, 0.01);\n                return <div key={i} style={{ flex: 1, height: `${(alr / maxAlr) * 34}px`, background: theme.accent.gold, borderRadius: '3px', opacity: 0.3 + (i/8)*0.7 }}/>;\n              })}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Bottom row: Update Rule + Hyperparameters */}\n      <div style={{ display: 'flex', gap: '16px', marginBottom: '16px' }}>\n        \n        {/* Update Rule */}\n        <div style={{ background: theme.bg.card, borderRadius: '12px', padding: '14px', flex: 1 }}>\n          <div style={{ fontSize: '11px', color: theme.text.muted, marginBottom: '6px' }}>Update Rule</div>\n          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px', fontSize: '16px', fontFamily: 'Georgia, serif' }}>\n            <span style={{ color: theme.accent.green }}>Œ∏</span>\n            <span style={{ color: theme.text.muted }}>=</span>\n            <span style={{ color: theme.accent.green }}>Œ∏</span>\n            <span style={{ color: theme.text.muted }}>‚àí</span>\n            <span style={{ color: theme.accent.gold }}>{adaptiveLr.toFixed(2)}</span>\n            <span style={{ color: theme.text.muted }}>√ó</span>\n            <span style={{ color: theme.accent.blue }}>{mHat.toFixed(2)}</span>\n            <span style={{ color: theme.text.muted }}>=</span>\n            <span style={{ color: theme.accent.green, fontFamily: 'monospace', fontWeight: '700', fontSize: '18px' }}>{adamX.toFixed(3)}</span>\n          </div>\n        </div>\n\n        {/* Hyperparameters */}\n        <div style={{ background: theme.bg.card, borderRadius: '12px', padding: '14px', display: 'flex', gap: '20px' }}>\n          {[\n            { label: 'lr', value: lr, set: setLr, min: 0.01, max: 2, step: 0.01, color: theme.accent.pink },\n            { label: 'Œ≤‚ÇÅ', value: beta1, set: setBeta1, min: 0.5, max: 0.99, step: 0.01, color: theme.accent.blue },\n            { label: 'Œ≤‚ÇÇ', value: beta2, set: setBeta2, min: 0.9, max: 0.999, step: 0.001, color: theme.accent.gold },\n          ].map(p => (\n            <div key={p.label} style={{ width: '70px' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>\n                <span style={{ fontSize: '11px', color: theme.text.secondary }}>{p.label}</span>\n                <span style={{ fontSize: '12px', color: p.color, fontFamily: 'monospace', fontWeight: '600' }}>{p.value}</span>\n              </div>\n              <input type=\"range\" min={p.min} max={p.max} step={p.step} value={p.value}\n                onChange={(e) => { p.set(parseFloat(e.target.value)); reset(startX); }}\n                style={{ width: '100%', accentColor: p.color }}/>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Insight Section */}\n      <div style={{ background: theme.bg.card, borderRadius: '12px', padding: '16px', border: `1px solid ${theme.border}` }}>\n        <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px' }}>\n          <div style={{ fontSize: '20px' }}>üí°</div>\n          <div>\n            <div style={{ fontSize: '12px', color: theme.accent.cyan, fontWeight: '600', marginBottom: '4px' }}>Key Insight</div>\n            <div style={{ fontSize: '13px', color: theme.text.secondary, lineHeight: '1.5' }}>{getInsight()}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showEditor": false,
    "editorWidthPercentage": 35,
    "showConsole": false
  },
  "dependencies": {}
}