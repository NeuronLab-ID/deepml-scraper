{
  "problem_id": 27,
  "title": "Transformation Matrix from Basis B to C",
  "category": "Linear Algebra",
  "enabled": true,
  "type": "react",
  "code": "import React, { useState, useMemo } from 'react';\n\nconst theme = {\n  colors: {\n    primary: '#8b5cf6',\n    background: '#0a0a0a',\n    surface: '#111111',\n    surfaceAlt: '#1a1a1a',\n    border: '#2a2a2a',\n    text: '#fafafa',\n    textSecondary: '#a1a1aa',\n    textMuted: '#52525b',\n    blue: '#38bdf8',\n    yellow: '#fbbf24',\n    pink: '#f472b6',\n    green: '#a3e635',\n    orange: '#fb923c',\n  },\n  font: \"'JetBrains Mono', monospace\",\n};\n\n// Solve for coefficients: a*basis[0] + b*basis[1] = point\nconst solve2x2 = (basis, point) => {\n  const [[b1x, b1y], [b2x, b2y]] = basis;\n  const [px, py] = point;\n  const det = b1x * b2y - b1y * b2x;\n  if (Math.abs(det) < 0.0001) return null;\n  return [(px * b2y - py * b2x) / det, (b1x * py - b1y * px) / det];\n};\n\nexport default function App() {\n  const [step, setStep] = useState(0);\n  const [playing, setPlaying] = useState(false);\n  const [point, setPoint] = useState([3, 2]);\n  \n  const B = [[1, 0], [0, 1]];\n  const [C, setC] = useState([[2, 0.5], [0.5, 1.5]]);\n\n  const numSteps = 4;\n\n  const coordsB = solve2x2(B, point);\n  const coordsC = solve2x2(C, point);\n\n  const stepInfo = [\n    { title: 'The Point', desc: 'A point exists in space, independent of any coordinate system', color: theme.colors.yellow },\n    { title: 'Basis B', desc: 'Measure the point using basis B (standard: →,↑)', color: theme.colors.blue },\n    { title: 'Basis C', desc: 'Measure the SAME point using basis C (different rulers)', color: theme.colors.pink },\n    { title: 'Transform', desc: 'P converts B-coordinates to C-coordinates', color: theme.colors.green },\n  ];\n\n  const play = async () => {\n    setPlaying(true);\n    for (let s = 0; s < numSteps; s++) {\n      setStep(s);\n      await new Promise(r => setTimeout(r, 2000));\n    }\n    setPlaying(false);\n  };\n\n  const reset = () => {\n    setStep(0); setPlaying(false); setPoint([3, 2]); setC([[2, 0.5], [0.5, 1.5]]);\n  };\n\n  // SVG helpers\n  const scale = 50;\n  const cx = 200, cy = 200;\n  const toSvg = (x, y) => [cx + x * scale, cy - y * scale];\n  const fromSvg = (sx, sy) => [(sx - cx) / scale, (cy - sy) / scale];\n\n  const Arrow = ({ from, to, color, width = 2.5 }) => {\n    const [x1, y1] = toSvg(from[0], from[1]);\n    const [x2, y2] = toSvg(to[0], to[1]);\n    const angle = Math.atan2(y1 - y2, x2 - x1);\n    const headLen = 8;\n    return (\n      <g>\n        <line x1={x1} y1={y1} x2={x2} y2={y2} stroke={color} strokeWidth={width} />\n        <polygon \n          points={`${x2},${y2} ${x2 - headLen * Math.cos(angle - 0.4)},${y2 + headLen * Math.sin(angle - 0.4)} ${x2 - headLen * Math.cos(angle + 0.4)},${y2 + headLen * Math.sin(angle + 0.4)}`}\n          fill={color} />\n      </g>\n    );\n  };\n\n  const Line = ({ from, to, color, dashed = false, width = 2 }) => {\n    const [x1, y1] = toSvg(from[0], from[1]);\n    const [x2, y2] = toSvg(to[0], to[1]);\n    return <line x1={x1} y1={y1} x2={x2} y2={y2} stroke={color} strokeWidth={width} strokeDasharray={dashed ? '5,5' : 'none'} />;\n  };\n\n  // Dragging\n  const [dragging, setDragging] = useState(false);\n  const handleMouseMove = (e) => {\n    if (!dragging || step > 0) return;\n    const rect = e.currentTarget.getBoundingClientRect();\n    const sx = e.clientX - rect.left;\n    const sy = e.clientY - rect.top;\n    const [x, y] = fromSvg(sx * (400 / rect.width), sy * (400 / rect.height));\n    setPoint([Math.round(x * 2) / 2, Math.round(y * 2) / 2]);\n  };\n\n  // Computed points for parallelograms\n  const scaledB1 = coordsB ? [coordsB[0] * B[0][0], coordsB[0] * B[0][1]] : [0,0];\n  const scaledB2 = coordsB ? [coordsB[1] * B[1][0], coordsB[1] * B[1][1]] : [0,0];\n  const scaledC1 = coordsC ? [coordsC[0] * C[0][0], coordsC[0] * C[0][1]] : [0,0];\n  const scaledC2 = coordsC ? [coordsC[1] * C[1][0], coordsC[1] * C[1][1]] : [0,0];\n\n  return (\n    <div style={{ background: theme.colors.background, minHeight: '100vh', padding: '12px', fontFamily: theme.font, color: theme.colors.text }}>\n      \n      {/* Header */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '10px' }}>\n        <div>\n          <div style={{ fontSize: '18px', fontWeight: '700' }}>Change of Basis</div>\n          <div style={{ fontSize: '12px', color: theme.colors.textSecondary }}>Same point, different coordinates</div>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n          <button onClick={() => setStep(Math.max(0, step - 1))} disabled={step === 0}\n            style={{ padding: '6px 12px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: step === 0 ? theme.colors.textMuted : theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'<'}</button>\n          <div style={{ display: 'flex', gap: '5px' }}>\n            {Array.from({ length: numSteps }, (_, i) => (\n              <div key={i} onClick={() => setStep(i)} style={{\n                width: i === step ? '18px' : '10px', height: '10px', borderRadius: '5px',\n                background: i <= step ? stepInfo[i].color : theme.colors.border, cursor: 'pointer'\n              }} />\n            ))}\n          </div>\n          <button onClick={() => setStep(Math.min(numSteps - 1, step + 1))} disabled={step === numSteps - 1}\n            style={{ padding: '6px 12px', background: step === numSteps - 1 ? theme.colors.surface : theme.colors.primary,\n              border: 'none', borderRadius: '6px', color: theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'>'}</button>\n          <button onClick={play} disabled={playing}\n            style={{ padding: '6px 12px', background: playing ? theme.colors.green : theme.colors.surface,\n              border: 'none', borderRadius: '6px', color: playing ? theme.colors.background : theme.colors.text,\n              fontSize: '12px', cursor: 'pointer' }}>{playing ? '...' : 'Play'}</button>\n          <button onClick={reset}\n            style={{ padding: '6px 10px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: theme.colors.textSecondary, fontSize: '14px', cursor: 'pointer' }}>~</button>\n        </div>\n      </div>\n\n      {/* Step info */}\n      <div style={{ padding: '8px 12px', background: theme.colors.surface, borderLeft: `3px solid ${stepInfo[step].color}`,\n        borderRadius: '0 6px 6px 0', marginBottom: '10px' }}>\n        <span style={{ fontWeight: '600', color: stepInfo[step].color, fontSize: '14px' }}>{stepInfo[step].title}: </span>\n        <span style={{ color: theme.colors.textSecondary, fontSize: '13px' }}>{stepInfo[step].desc}</span>\n      </div>\n\n      <div style={{ display: 'flex', gap: '10px', marginBottom: '10px' }}>\n        {/* Main Visualization */}\n        <div style={{ flex: 1.3, background: theme.colors.surface, borderRadius: '10px', padding: '10px' }}>\n          <svg viewBox=\"0 0 400 400\" style={{ width: '100%', height: '340px', cursor: step === 0 ? 'crosshair' : 'default' }}\n            onMouseMove={handleMouseMove}\n            onMouseDown={() => step === 0 && setDragging(true)}\n            onMouseUp={() => setDragging(false)}\n            onMouseLeave={() => setDragging(false)}>\n            <rect x=\"0\" y=\"0\" width=\"400\" height=\"400\" fill={theme.colors.surfaceAlt} rx=\"8\" />\n            \n            {/* Grid */}\n            {[-4,-3,-2,-1,0,1,2,3,4].map(i => (\n              <g key={i}>\n                <line x1={cx + i * scale} y1=\"10\" x2={cx + i * scale} y2=\"390\" stroke={theme.colors.border} strokeWidth=\"0.5\" />\n                <line x1=\"10\" y1={cy - i * scale} x2=\"390\" y2={cy - i * scale} stroke={theme.colors.border} strokeWidth=\"0.5\" />\n              </g>\n            ))}\n            \n            {/* Origin axes */}\n            <line x1=\"10\" y1={cy} x2=\"390\" y2={cy} stroke={theme.colors.textMuted} strokeWidth=\"1\" />\n            <line x1={cx} y1=\"10\" x2={cx} y2=\"390\" stroke={theme.colors.textMuted} strokeWidth=\"1\" />\n            \n            {/* Basis B decomposition */}\n            {step >= 1 && coordsB && (\n              <>\n                {/* Parallelogram for B */}\n                <Line from={[0, 0]} to={scaledB1} color={theme.colors.blue} width={3} />\n                <Line from={scaledB1} to={point} color={theme.colors.blue} dashed={true} />\n                <Line from={[0, 0]} to={scaledB2} color={theme.colors.blue} width={3} />\n                <Line from={scaledB2} to={point} color={theme.colors.blue} dashed={true} />\n                \n                {/* Coefficient labels */}\n                <text x={toSvg(scaledB1[0]/2, -0.3)[0]} y={toSvg(0, -0.3)[1]} fill={theme.colors.blue} fontSize=\"14\" fontWeight=\"bold\" textAnchor=\"middle\">\n                  {coordsB[0].toFixed(1)}\n                </text>\n                <text x={toSvg(-0.4, scaledB2[1]/2)[0]} y={toSvg(0, scaledB2[1]/2)[1]} fill={theme.colors.blue} fontSize=\"14\" fontWeight=\"bold\" textAnchor=\"middle\">\n                  {coordsB[1].toFixed(1)}\n                </text>\n              </>\n            )}\n            \n            {/* Basis C decomposition */}\n            {step >= 2 && coordsC && (\n              <>\n                {/* Unit basis vectors */}\n                <Arrow from={[0, 0]} to={C[0]} color={theme.colors.pink} width={1.5} />\n                <Arrow from={[0, 0]} to={C[1]} color={theme.colors.pink} width={1.5} />\n                <text x={toSvg(C[0][0], C[0][1])[0] + 10} y={toSvg(C[0][0], C[0][1])[1]} fill={theme.colors.pink} fontSize=\"11\" fontWeight=\"600\">c₁</text>\n                <text x={toSvg(C[1][0], C[1][1])[0] + 10} y={toSvg(C[1][0], C[1][1])[1]} fill={theme.colors.pink} fontSize=\"11\" fontWeight=\"600\">c₂</text>\n                \n                {/* Parallelogram: origin → scaled c1 → point, and origin → scaled c2 → point */}\n                <Line from={[0, 0]} to={scaledC1} color={theme.colors.pink} width={3} />\n                <Line from={scaledC1} to={point} color={theme.colors.pink} dashed={true} />\n                <Line from={[0, 0]} to={scaledC2} color={theme.colors.pink} width={3} />\n                <Line from={scaledC2} to={point} color={theme.colors.pink} dashed={true} />\n                \n                {/* Coefficient labels */}\n                <text x={toSvg(scaledC1[0]/2 + 0.2, scaledC1[1]/2 + 0.3)[0]} y={toSvg(scaledC1[0]/2, scaledC1[1]/2)[1]} \n                  fill={theme.colors.pink} fontSize=\"12\" fontWeight=\"bold\">{coordsC[0].toFixed(2)}</text>\n                <text x={toSvg(scaledC2[0]/2 - 0.4, scaledC2[1]/2)[0]} y={toSvg(scaledC2[0]/2, scaledC2[1]/2)[1]} \n                  fill={theme.colors.pink} fontSize=\"12\" fontWeight=\"bold\">{coordsC[1].toFixed(2)}</text>\n              </>\n            )}\n            \n            {/* The point */}\n            <circle cx={toSvg(point[0], point[1])[0]} cy={toSvg(point[0], point[1])[1]} r=\"10\" \n              fill={theme.colors.yellow} stroke=\"#fff\" strokeWidth=\"2\" />\n            <text x={toSvg(point[0], point[1])[0]} y={toSvg(point[0], point[1])[1] - 18} \n              fill={theme.colors.yellow} fontSize=\"13\" fontWeight=\"bold\" textAnchor=\"middle\">P</text>\n            \n            {/* Origin */}\n            <circle cx={cx} cy={cy} r=\"4\" fill={theme.colors.text} />\n          </svg>\n          \n          {step === 0 && (\n            <div style={{ textAlign: 'center', fontSize: '11px', color: theme.colors.textMuted, marginTop: '5px' }}>\n              Drag the point P to move it\n            </div>\n          )}\n        </div>\n\n        {/* Right Panel */}\n        <div style={{ flex: 0.7, display: 'flex', flexDirection: 'column', gap: '10px' }}>\n          \n          {/* The point */}\n          <div style={{ background: theme.colors.surface, borderRadius: '8px', padding: '12px',\n            border: `2px solid ${step === 0 ? theme.colors.yellow : theme.colors.border}` }}>\n            <div style={{ fontSize: '12px', color: theme.colors.yellow, marginBottom: '6px', fontWeight: '600' }}>\n              The Point P\n            </div>\n            <div style={{ fontSize: '11px', color: theme.colors.textSecondary }}>Location in space</div>\n            <div style={{ fontSize: '20px', color: theme.colors.yellow, fontWeight: '700', marginTop: '4px' }}>\n              ({point[0]}, {point[1]})\n            </div>\n          </div>\n          \n          {/* Coordinates in B */}\n          {step >= 1 && coordsB && (\n            <div style={{ background: theme.colors.surface, borderRadius: '8px', padding: '12px',\n              borderLeft: `3px solid ${theme.colors.blue}` }}>\n              <div style={{ fontSize: '12px', color: theme.colors.blue, marginBottom: '4px', fontWeight: '600' }}>\n                In Basis B (standard)\n              </div>\n              <div style={{ fontSize: '11px', color: theme.colors.textSecondary, marginBottom: '6px' }}>\n                b₁ = [1,0], b₂ = [0,1]\n              </div>\n              <div style={{ fontSize: '11px', color: theme.colors.textSecondary }}>\n                P = <span style={{ color: theme.colors.blue, fontWeight: '600' }}>{coordsB[0].toFixed(1)}</span>·b₁ + <span style={{ color: theme.colors.blue, fontWeight: '600' }}>{coordsB[1].toFixed(1)}</span>·b₂\n              </div>\n              <div style={{ fontSize: '18px', color: theme.colors.blue, fontWeight: '700', marginTop: '4px' }}>\n                [{coordsB[0].toFixed(1)}, {coordsB[1].toFixed(1)}]<sub style={{ fontSize: '10px' }}>B</sub>\n              </div>\n            </div>\n          )}\n          \n          {/* Coordinates in C */}\n          {step >= 2 && coordsC && (\n            <div style={{ background: theme.colors.surface, borderRadius: '8px', padding: '12px',\n              borderLeft: `3px solid ${theme.colors.pink}` }}>\n              <div style={{ fontSize: '12px', color: theme.colors.pink, marginBottom: '4px', fontWeight: '600' }}>\n                In Basis C (custom)\n              </div>\n              <div style={{ fontSize: '11px', color: theme.colors.textSecondary, marginBottom: '6px' }}>\n                c₁ = [{C[0][0]},{C[0][1]}], c₂ = [{C[1][0]},{C[1][1]}]\n              </div>\n              <div style={{ fontSize: '11px', color: theme.colors.textSecondary }}>\n                P = <span style={{ color: theme.colors.pink, fontWeight: '600' }}>{coordsC[0].toFixed(2)}</span>·c₁ + <span style={{ color: theme.colors.pink, fontWeight: '600' }}>{coordsC[1].toFixed(2)}</span>·c₂\n              </div>\n              <div style={{ fontSize: '18px', color: theme.colors.pink, fontWeight: '700', marginTop: '4px' }}>\n                [{coordsC[0].toFixed(2)}, {coordsC[1].toFixed(2)}]<sub style={{ fontSize: '10px' }}>C</sub>\n              </div>\n            </div>\n          )}\n          \n          {/* The transformation */}\n          {step >= 3 && coordsB && coordsC && (\n            <div style={{ background: theme.colors.green + '15', borderRadius: '8px', padding: '12px',\n              border: `2px solid ${theme.colors.green}` }}>\n              <div style={{ fontSize: '12px', color: theme.colors.green, marginBottom: '6px', fontWeight: '600' }}>\n                Matrix P = C⁻¹B\n              </div>\n              <div style={{ fontSize: '13px', color: theme.colors.textSecondary, display: 'flex', alignItems: 'center', gap: '6px', flexWrap: 'wrap' }}>\n                <span style={{ color: theme.colors.blue, fontWeight: '600' }}>[{coordsB[0].toFixed(1)}, {coordsB[1].toFixed(1)}]<sub>B</sub></span>\n                <span style={{ fontSize: '16px' }}>→</span>\n                <span style={{ color: theme.colors.pink, fontWeight: '600' }}>[{coordsC[0].toFixed(2)}, {coordsC[1].toFixed(2)}]<sub>C</sub></span>\n              </div>\n              <div style={{ fontSize: '11px', color: theme.colors.textMuted, marginTop: '6px' }}>\n                Same point P, different numbers!\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Key Insight */}\n      <div style={{ background: theme.colors.surfaceAlt, borderRadius: '8px', padding: '10px 14px',\n        fontSize: '12px', color: theme.colors.textSecondary, borderLeft: `3px solid ${theme.colors.primary}` }}>\n        <span style={{ color: theme.colors.primary, fontWeight: '600' }}>Key: </span>\n        {step === 0 && 'A point exists in space. Coordinates are just how we DESCRIBE it — they depend on our choice of basis.'}\n        {step === 1 && 'Basis B: \"go 3 along b₁, then 2 along b₂.\" Coordinates = how much of each basis vector to add.'}\n        {step === 2 && 'Basis C: we need DIFFERENT amounts of c₁ and c₂ to reach the SAME point. The parallelograms both end at P!'}\n        {step === 3 && 'Matrix P = C⁻¹B converts: \"what amounts in C reach the same point as these amounts in B?\"'}\n      </div>\n    </div>\n  );\n}",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showEditor": false,
    "editorWidthPercentage": 35,
    "showConsole": false
  },
  "dependencies": {}
}