{
  "problem_id": 56,
  "title": "KL Divergence Between Two Normal Distributions",
  "category": "Deep Learning",
  "enabled": true,
  "type": "react",
  "code": "\nimport React, { useState, useMemo, useRef } from 'react';\n\nconst theme = {\n  bg: '#0f172a',\n  surface: '#1e293b',\n  card: '#334155',\n  border: '#475569',\n  text: '#f8fafc',\n  muted: '#94a3b8',\n  dim: '#64748b',\n  p: '#38bdf8',\n  q: '#f472b6',\n  kl: '#4ade80',\n  orange: '#fb923c',\n};\n\nconst normalPdf = (x, mu, sigma) => {\n  const coef = 1 / (sigma * Math.sqrt(2 * Math.PI));\n  const exp = Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2));\n  return coef * exp;\n};\n\nconst klDivergence = (muP, sigmaP, muQ, sigmaQ) => {\n  const term1 = Math.log(sigmaQ / sigmaP);\n  const term2 = (sigmaP ** 2 + (muP - muQ) ** 2) / (2 * sigmaQ ** 2);\n  return term1 + term2 - 0.5;\n};\n\nexport default function App() {\n  const [muP, setMuP] = useState(0);\n  const [sigmaP, setSigmaP] = useState(1);\n  const [muQ, setMuQ] = useState(1.5);\n  const [sigmaQ, setSigmaQ] = useState(1.5);\n  const [dragging, setDragging] = useState(null);\n  const svgRef = useRef(null);\n\n  const kl = useMemo(() => klDivergence(muP, sigmaP, muQ, sigmaQ), [muP, sigmaP, muQ, sigmaQ]);\n\n  const generateCurve = (mu, sigma) => {\n    const points = [];\n    for (let x = -6; x <= 6; x += 0.1) {\n      points.push({ x, y: normalPdf(x, mu, sigma) });\n    }\n    return points;\n  };\n\n  const curveP = useMemo(() => generateCurve(muP, sigmaP), [muP, sigmaP]);\n  const curveQ = useMemo(() => generateCurve(muQ, sigmaQ), [muQ, sigmaQ]);\n\n  const width = 520;\n  const height = 240;\n  const padding = { top: 20, right: 30, bottom: 35, left: 45 };\n  const plotW = width - padding.left - padding.right;\n  const plotH = height - padding.top - padding.bottom;\n\n  const xScale = (x) => padding.left + ((x + 6) / 12) * plotW;\n  const yScale = (y) => padding.top + plotH - (y / 0.6) * plotH;\n  const xScaleInverse = (px) => ((px - padding.left) / plotW) * 12 - 6;\n  const yScaleInverse = (py) => (1 - (py - padding.top) / plotH) * 0.6;\n\n  const pathD = (curve) => {\n    return curve.map((p, i) => \n      `${i === 0 ? 'M' : 'L'} ${xScale(p.x)} ${yScale(Math.min(p.y, 0.6))}`\n    ).join(' ');\n  };\n\n  const peakHeightToSigma = (peakY) => {\n    const sigma = 1 / (peakY * Math.sqrt(2 * Math.PI));\n    return Math.max(0.3, Math.min(3, sigma));\n  };\n\n  const handleMouseDown = (dist) => (e) => {\n    e.preventDefault();\n    setDragging(dist);\n  };\n\n  const handleMouseMove = (e) => {\n    if (!dragging || !svgRef.current) return;\n    \n    const svg = svgRef.current;\n    const rect = svg.getBoundingClientRect();\n    const scaleX = width / rect.width;\n    const scaleY = height / rect.height;\n    const px = (e.clientX - rect.left) * scaleX;\n    const py = (e.clientY - rect.top) * scaleY;\n    \n    const newMu = Math.max(-5, Math.min(5, xScaleInverse(px)));\n    const newPeakY = Math.max(0.15, Math.min(0.55, yScaleInverse(py)));\n    const newSigma = peakHeightToSigma(newPeakY);\n    \n    if (dragging === 'P') {\n      setMuP(Math.round(newMu * 10) / 10);\n      setSigmaP(Math.round(newSigma * 10) / 10);\n    } else if (dragging === 'Q') {\n      setMuQ(Math.round(newMu * 10) / 10);\n      setSigmaQ(Math.round(newSigma * 10) / 10);\n    }\n  };\n\n  const handleMouseUp = () => {\n    setDragging(null);\n  };\n\n  const term1 = Math.log(sigmaQ / sigmaP);\n  const term2 = (sigmaP ** 2 + (muP - muQ) ** 2) / (2 * sigmaQ ** 2);\n\n  const peakP = normalPdf(muP, muP, sigmaP);\n  const peakQ = normalPdf(muQ, muQ, sigmaQ);\n\n  return (\n    <div style={styles.container}>\n      <div style={styles.header}>\n        <h1 style={styles.title}>KL Divergence</h1>\n        <p style={styles.subtitle}>Drag the peaks: ← → for mean, ↑ ↓ for spread</p>\n      </div>\n\n      <div style={styles.klResultBox}>\n        <div style={styles.klLabel}>KL(P ‖ Q)</div>\n        <div style={styles.klValue}>{kl.toFixed(4)}</div>\n        <div style={styles.klNote}>\n          {kl < 0.1 ? 'Very similar' : kl < 0.5 ? 'Somewhat different' : 'Very different'}\n        </div>\n      </div>\n\n      <div style={styles.plotSection}>\n        <svg \n          ref={svgRef}\n          width=\"100%\" \n          viewBox={`0 0 ${width} ${height}`} \n          style={{...styles.svg, cursor: dragging ? 'grabbing' : 'default'}}\n          onMouseMove={handleMouseMove}\n          onMouseUp={handleMouseUp}\n          onMouseLeave={handleMouseUp}\n        >\n          {[-4, -2, 0, 2, 4].map(x => (\n            <line key={x} x1={xScale(x)} y1={padding.top} x2={xScale(x)} y2={height - padding.bottom}\n              stroke={theme.border} strokeWidth=\"1\" opacity=\"0.3\" />\n          ))}\n          {[0.1, 0.2, 0.3, 0.4, 0.5].map(y => (\n            <line key={y} x1={padding.left} y1={yScale(y)} x2={width - padding.right} y2={yScale(y)}\n              stroke={theme.border} strokeWidth=\"1\" opacity=\"0.3\" />\n          ))}\n\n          <line x1={padding.left} y1={height - padding.bottom} \n                x2={width - padding.right} y2={height - padding.bottom}\n                stroke={theme.muted} strokeWidth=\"1.5\" />\n          <line x1={padding.left} y1={padding.top} \n                x2={padding.left} y2={height - padding.bottom}\n                stroke={theme.muted} strokeWidth=\"1.5\" />\n\n          {[-4, -2, 0, 2, 4].map(x => (\n            <text key={x} x={xScale(x)} y={height - 12} textAnchor=\"middle\" \n                  fill={theme.dim} fontSize=\"11\">{x}</text>\n          ))}\n          \n          <text x={padding.left - 8} y={padding.top + 10} textAnchor=\"end\" fill={theme.dim} fontSize=\"10\">p(x)</text>\n\n          <path d={`${pathD(curveP)} L ${xScale(6)} ${yScale(0)} L ${xScale(-6)} ${yScale(0)} Z`}\n                fill={theme.p} opacity=\"0.2\" />\n          <path d={`${pathD(curveQ)} L ${xScale(6)} ${yScale(0)} L ${xScale(-6)} ${yScale(0)} Z`}\n                fill={theme.q} opacity=\"0.2\" />\n\n          <path d={pathD(curveP)} fill=\"none\" stroke={theme.p} strokeWidth=\"3\" />\n          <path d={pathD(curveQ)} fill=\"none\" stroke={theme.q} strokeWidth=\"3\" />\n\n          <g onMouseDown={handleMouseDown('P')} style={{cursor: 'grab'}}>\n            <circle cx={xScale(muP)} cy={yScale(peakP)} r=\"20\" fill=\"transparent\" />\n            <circle cx={xScale(muP)} cy={yScale(peakP)} r=\"10\" fill={theme.p} stroke={theme.bg} strokeWidth=\"3\" />\n            <line x1={xScale(muP) - 15} y1={yScale(peakP)} x2={xScale(muP) - 6} y2={yScale(peakP)} stroke={theme.bg} strokeWidth=\"2\" />\n            <line x1={xScale(muP) + 6} y1={yScale(peakP)} x2={xScale(muP) + 15} y2={yScale(peakP)} stroke={theme.bg} strokeWidth=\"2\" />\n            <line x1={xScale(muP)} y1={yScale(peakP) - 15} x2={xScale(muP)} y2={yScale(peakP) - 6} stroke={theme.bg} strokeWidth=\"2\" />\n            <line x1={xScale(muP)} y1={yScale(peakP) + 6} x2={xScale(muP)} y2={yScale(peakP) + 15} stroke={theme.bg} strokeWidth=\"2\" />\n          </g>\n\n          <g onMouseDown={handleMouseDown('Q')} style={{cursor: 'grab'}}>\n            <circle cx={xScale(muQ)} cy={yScale(peakQ)} r=\"20\" fill=\"transparent\" />\n            <circle cx={xScale(muQ)} cy={yScale(peakQ)} r=\"10\" fill={theme.q} stroke={theme.bg} strokeWidth=\"3\" />\n            <line x1={xScale(muQ) - 15} y1={yScale(peakQ)} x2={xScale(muQ) - 6} y2={yScale(peakQ)} stroke={theme.bg} strokeWidth=\"2\" />\n            <line x1={xScale(muQ) + 6} y1={yScale(peakQ)} x2={xScale(muQ) + 15} y2={yScale(peakQ)} stroke={theme.bg} strokeWidth=\"2\" />\n            <line x1={xScale(muQ)} y1={yScale(peakQ) - 15} x2={xScale(muQ)} y2={yScale(peakQ) - 6} stroke={theme.bg} strokeWidth=\"2\" />\n            <line x1={xScale(muQ)} y1={yScale(peakQ) + 6} x2={xScale(muQ)} y2={yScale(peakQ) + 15} stroke={theme.bg} strokeWidth=\"2\" />\n          </g>\n\n          <text x={xScale(muP)} y={height - padding.bottom + 25} textAnchor=\"middle\" fill={theme.p} fontSize=\"11\" fontWeight=\"600\">\n            μ={muP.toFixed(1)}, σ={sigmaP.toFixed(1)}\n          </text>\n          <text x={xScale(muQ)} y={height - padding.bottom + 25} textAnchor=\"middle\" fill={theme.q} fontSize=\"11\" fontWeight=\"600\">\n            μ={muQ.toFixed(1)}, σ={sigmaQ.toFixed(1)}\n          </text>\n        </svg>\n\n        <div style={styles.legend}>\n          <div style={styles.legendItem}>\n            <div style={{...styles.legendLine, background: theme.p}} />\n            <span>P ~ N({muP.toFixed(1)}, {sigmaP.toFixed(1)}²)</span>\n          </div>\n          <div style={styles.legendItem}>\n            <div style={{...styles.legendLine, background: theme.q}} />\n            <span>Q ~ N({muQ.toFixed(1)}, {sigmaQ.toFixed(1)}²)</span>\n          </div>\n        </div>\n      </div>\n\n      <div style={styles.controlsSection}>\n        <div style={styles.distControls}>\n          <div style={styles.distHeader}>\n            <div style={{...styles.distDot, background: theme.p}} />\n            <span>Distribution P</span>\n          </div>\n          <div style={styles.sliderGroup}>\n            <div style={styles.sliderRow}>\n              <span style={styles.sliderLabel}>μ<sub>P</sub></span>\n              <input type=\"range\" min=\"-5\" max=\"5\" step=\"0.1\" value={muP}\n                onChange={e => setMuP(+e.target.value)} style={{...styles.range, accentColor: theme.p}} />\n              <span style={{...styles.sliderValue, color: theme.p}}>{muP.toFixed(1)}</span>\n            </div>\n            <div style={styles.sliderRow}>\n              <span style={styles.sliderLabel}>σ<sub>P</sub></span>\n              <input type=\"range\" min=\"0.3\" max=\"3\" step=\"0.1\" value={sigmaP}\n                onChange={e => setSigmaP(+e.target.value)} style={{...styles.range, accentColor: theme.p}} />\n              <span style={{...styles.sliderValue, color: theme.p}}>{sigmaP.toFixed(1)}</span>\n            </div>\n          </div>\n        </div>\n\n        <div style={styles.distControls}>\n          <div style={styles.distHeader}>\n            <div style={{...styles.distDot, background: theme.q}} />\n            <span>Distribution Q</span>\n          </div>\n          <div style={styles.sliderGroup}>\n            <div style={styles.sliderRow}>\n              <span style={styles.sliderLabel}>μ<sub>Q</sub></span>\n              <input type=\"range\" min=\"-5\" max=\"5\" step=\"0.1\" value={muQ}\n                onChange={e => setMuQ(+e.target.value)} style={{...styles.range, accentColor: theme.q}} />\n              <span style={{...styles.sliderValue, color: theme.q}}>{muQ.toFixed(1)}</span>\n            </div>\n            <div style={styles.sliderRow}>\n              <span style={styles.sliderLabel}>σ<sub>Q</sub></span>\n              <input type=\"range\" min=\"0.3\" max=\"3\" step=\"0.1\" value={sigmaQ}\n                onChange={e => setSigmaQ(+e.target.value)} style={{...styles.range, accentColor: theme.q}} />\n              <span style={{...styles.sliderValue, color: theme.q}}>{sigmaQ.toFixed(1)}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div style={styles.formulaSection}>\n        <div style={styles.formulaTitle}>Formula Breakdown</div>\n        <div style={styles.formulaMain}>\n          KL(P‖Q) = log(σ<sub>Q</sub>/σ<sub>P</sub>) + (σ<sub>P</sub>² + (μ<sub>P</sub>−μ<sub>Q</sub>)²) / 2σ<sub>Q</sub>² − ½\n        </div>\n        <div style={styles.formulaTerms}>\n          <div style={styles.term}>\n            <div style={styles.termLabel}>log(σ<sub>Q</sub>/σ<sub>P</sub>)</div>\n            <div style={styles.termValue}>{term1.toFixed(4)}</div>\n          </div>\n          <div style={styles.termOp}>+</div>\n          <div style={styles.term}>\n            <div style={styles.termLabel}>(σ<sub>P</sub>² + Δμ²) / 2σ<sub>Q</sub>²</div>\n            <div style={styles.termValue}>{term2.toFixed(4)}</div>\n          </div>\n          <div style={styles.termOp}>−</div>\n          <div style={styles.term}>\n            <div style={styles.termLabel}>½</div>\n            <div style={styles.termValue}>0.5</div>\n          </div>\n          <div style={styles.termOp}>=</div>\n          <div style={styles.term}>\n            <div style={styles.termLabel}>KL</div>\n            <div style={{...styles.termValue, color: theme.kl, fontWeight: 700, fontSize: 14}}>{kl.toFixed(4)}</div>\n          </div>\n        </div>\n      </div>\n\n      <div style={styles.insightBox}>\n        <div style={styles.insightTitle}>⚠️ Asymmetric!</div>\n        <div style={styles.insightText}>\n          KL(P‖Q) ≠ KL(Q‖P) — divergence depends on direction\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst styles = {\n  container: {\n    fontFamily: \"'Inter', -apple-system, sans-serif\",\n    background: theme.bg,\n    color: theme.text,\n    padding: 16,\n    maxWidth: 580,\n    margin: '0 auto',\n    minHeight: '100vh',\n  },\n  header: { textAlign: 'center', marginBottom: 14 },\n  title: { fontSize: 22, fontWeight: 700, margin: 0 },\n  subtitle: { fontSize: 12, color: theme.muted, margin: '6px 0 0' },\n\n  klResultBox: {\n    background: `linear-gradient(135deg, ${theme.surface}, ${theme.card})`,\n    borderRadius: 12, padding: 18, marginBottom: 14, textAlign: 'center',\n    border: `1px solid ${theme.kl}40`,\n  },\n  klLabel: { fontSize: 13, color: theme.muted, marginBottom: 4 },\n  klValue: { fontSize: 36, fontWeight: 700, color: theme.kl },\n  klNote: { fontSize: 11, color: theme.dim, marginTop: 6 },\n\n  plotSection: {\n    background: theme.surface, borderRadius: 12, padding: 14, marginBottom: 14,\n  },\n  svg: { display: 'block', userSelect: 'none' },\n  legend: {\n    display: 'flex', justifyContent: 'center', gap: 30, marginTop: 10,\n  },\n  legendItem: { display: 'flex', alignItems: 'center', gap: 8, fontSize: 12, color: theme.muted },\n  legendLine: { width: 24, height: 4, borderRadius: 2 },\n\n  controlsSection: {\n    display: 'flex', gap: 14, marginBottom: 14,\n  },\n  distControls: {\n    flex: 1, background: theme.surface, borderRadius: 12, padding: 14,\n  },\n  distHeader: {\n    display: 'flex', alignItems: 'center', gap: 10, marginBottom: 12,\n    fontSize: 13, color: theme.text, fontWeight: 600,\n  },\n  distDot: { width: 12, height: 12, borderRadius: '50%' },\n  sliderGroup: {},\n  sliderRow: {\n    display: 'flex', alignItems: 'center', gap: 10, marginBottom: 10,\n  },\n  sliderLabel: { fontSize: 13, color: theme.muted, width: 28 },\n  range: { flex: 1, height: 4 },\n  sliderValue: { fontSize: 13, fontWeight: 600, width: 36, textAlign: 'right' },\n\n  formulaSection: {\n    background: theme.surface, borderRadius: 12, padding: 16, marginBottom: 14,\n  },\n  formulaTitle: { fontSize: 11, color: theme.dim, marginBottom: 10, textAlign: 'center' },\n  formulaMain: {\n    fontSize: 12, color: theme.muted, textAlign: 'center', marginBottom: 14,\n    fontFamily: 'monospace', lineHeight: 1.6,\n  },\n  formulaTerms: {\n    display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 8,\n    flexWrap: 'wrap',\n  },\n  term: { textAlign: 'center', padding: '8px 10px', background: theme.card, borderRadius: 8 },\n  termLabel: { fontSize: 9, color: theme.dim, marginBottom: 3 },\n  termValue: { fontSize: 13, color: theme.muted, fontFamily: 'monospace' },\n  termOp: { fontSize: 16, color: theme.dim },\n\n  insightBox: {\n    background: `${theme.orange}15`, borderRadius: 12, padding: 14, textAlign: 'center',\n  },\n  insightTitle: { fontSize: 12, color: theme.orange, fontWeight: 600, marginBottom: 4 },\n  insightText: { fontSize: 11, color: theme.muted },\n};\n",
  "settings": {
    "editorHeight": 600,
    "showPreview": true,
    "theme": "auto",
    "showConsole": false,
    "editorWidthPercentage": 35,
    "showEditor": false
  },
  "dependencies": {}
}